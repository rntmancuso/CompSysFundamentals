

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>4. The Shell - Part I: Having an ASCII conversation with the OS &#8212; UndertheCovers</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'unix/shellintro';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="5. The Shell - Part II: Some UNIX details" href="shelldetails.html" />
    <link rel="prev" title="3. Organizing and Managing Information as a Tree of Files and Directories" href="files.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro_tb.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.jpg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.jpg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro_tb.html">
                    CS 350 - Fundamentals of Computing Systems
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">How to read this book</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../howto.html">How to read this book</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">The Unix Development Environment</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="intro.html">1. Operating Systems and UNIX</a></li>
<li class="toctree-l1"><a class="reference internal" href="terminal.html">2. What is a Terminal and why do we still use them?</a></li>
<li class="toctree-l1"><a class="reference internal" href="files.html">3. Organizing and Managing Information as a Tree of Files and Directories</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">4. The Shell - Part I: Having an ASCII conversation with the OS</a></li>
<li class="toctree-l1"><a class="reference internal" href="shelldetails.html">5. The Shell - Part II: Some UNIX details</a></li>
<li class="toctree-l1"><a class="reference internal" href="editors.html">6. Editors</a></li>
<li class="toctree-l1"><a class="reference internal" href="processes.html">7. Processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="ides.html">8. IDEs</a></li>
<li class="toctree-l1"><a class="reference internal" href="make.html">9. Make</a></li>
<li class="toctree-l1"><a class="reference internal" href="gitintro.html">10. Intro to Git</a></li>
<li class="toctree-l1"><a class="reference internal" href="git.html">11. Git</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">The Belly of the Beast: The von Neumann Architecture and Assembly Programming</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../assembly/intro.html">12. Introduction: Assembly Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../assembly/vonNeumannArchitecture.html">13. The von Neumann Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../assembly/UnixAssemblyProgramming.html">14. Executables and Processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../assembly/Debuggers.html">15. Machine Debuggers &amp; Open Process Surgery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../assembly/assembly.html">16. Lets write some assembly code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../assembly/InfoRepI.html">17. Representing information - Preliminaries: Bits, Bytes and Notation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../assembly/nativetypes.html">18. Information Representation - Native Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../assembly/anatomyI.html">19. Assembly : Program Anatomy I</a></li>
<li class="toctree-l1"><a class="reference internal" href="../assembly/anatomyII.html">20. Program Anatomy II : Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../assembly/anatomyIII.html">21. Program Anatomy III : Code as Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../assembly/anatomyIV.html">22. Program Anatomy IV: The Tree of Bytes and Data Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../assembly/assemblyOS.html">23. Assembly using the OS</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Into the Light : C Programming</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../C/intro.html">24. Introduction</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Course Specific Material</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../BUCS210_intro.html">BU CS210 Overview</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/jappavoo/UndertheCovers" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/jappavoo/UndertheCovers/edit/main/underthecovers/unix/shellintro.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/jappavoo/UndertheCovers/issues/new?title=Issue%20on%20page%20%2Funix/shellintro.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/unix/shellintro.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>The Shell - Part I: Having an ASCII conversation with the OS</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#our-interface-to-the-kernel">4.1. Our interface to the Kernel</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#system-calls">4.1.1. System calls</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bash">4.2. Bash</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#documentation-and-manuals">4.2.1. Documentation and manuals</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#man-bash">4.2.2. man bash</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#info-bash">4.2.2.1. info bash</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bash-builtin-help">4.2.2.2. bash builtin <code class="docutils literal notranslate"><span class="pre">help</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#shell-session">4.3. Shell Session</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#terminal-windows-and-the-shell">4.3.1. Terminal Windows and the Shell</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#line-oriented-conversation">4.4. Line oriented conversation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lines">4.4.1. Lines</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-prompt">4.4.2. The Prompt</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#our-first-shell-session">4.5. Our first shell session</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#command-lines">4.6. Command lines</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#three-simple-examples">4.6.1. Three simple examples</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#command-line-processing">4.7. Command line processing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interactive-vs-non-interactive-scripts">4.7.1. Interactive vs non-interactive (scripts)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overview-the-six-steps-of-command-line-processing">4.7.2. Overview: The six steps of command line processing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-breaking-down-a-command-line-into-simple-commands-and-arguments">4.7.3. Step 1: Breaking down a “Command line” into Simple Commands and Arguments</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#command-versus-arguments">4.7.3.1. Command versus Arguments</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#comments">4.7.3.2. Comments</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-command-line-splitting-examples">4.7.3.3. Simple Command Line Splitting examples</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#quotes-and-command-line-splitting">4.7.3.4. Quotes and Command Line Splitting</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#escaping-blanks">4.7.3.4.1. Escaping blanks</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">4.7.3.5. Summary</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#command-line-history">4.7.3.6. Command line history</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-perform-expansions">4.7.4. Step 2: Perform Expansions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nine-command-line-expansions">4.7.4.1. Nine Command line Expansions</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#brace-expansion">4.7.4.1.1. Brace Expansion</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#tilde-expansion">4.7.4.1.2. Tilde Expansion</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#parameter-and-variable-expansion">4.7.4.1.3. Parameter and Variable Expansion</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#command-substitution">4.7.4.1.4. Command Substitution</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#arithmetic-expansion">4.7.4.1.5. Arithmetic Expansion</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#process-substitution">4.7.4.1.6. Process Substitution</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#word-splitting-on-expansion">4.7.4.1.7. Word Splitting on Expansion</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#filename-expansion">4.7.4.1.8. Filename Expansion</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#quote-removal">4.7.4.1.9. Quote Removal</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#quoting-and-expansions">4.7.4.2. Quoting and Expansions</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#single-quotes">4.7.4.3. Single quotes</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#double-quotes">4.7.4.4. Double quotes</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-parse-redirections">4.7.5. Step 3: Parse Redirections</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#processes">4.7.5.1. Processes</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#streams-standard-input-output-and-error">4.7.5.2. Streams: Standard Input, Output and Error</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ascii-streams">4.7.5.3. ASCII streams</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#standard-error">4.7.5.3.1. Standard Error</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#streams-and-files">4.7.5.4. Streams and Files</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#opening-streams-and-file-descriptors">4.7.5.5. Opening streams and File Descriptors</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#terminals-and-streams">4.7.5.6. Terminals and Streams</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#defaults">4.7.5.7. Defaults</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#overriding-the-defaults">4.7.5.8. Overriding the defaults</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#redirection-examples">4.7.5.9. Redirection Examples</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#standard-output-and-redirection">4.7.5.9.1. Standard output and redirection</a><ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#appending-to-a-file">4.7.5.9.1.1. Appending to a file</a></li>
</ul>
</li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#standard-input-redirection">4.7.5.9.2. Standard Input redirection</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#pipes">4.7.5.9.3. Pipes</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#standard-error-redirection">4.7.5.9.4. Standard Error redirection</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-execute-the-command">4.7.6. Step 4: Execute the command</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#builtin-vs-externals">4.7.6.1. Builtin vs Externals</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#builtins">4.7.6.1.1. Builtins</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#external-shell-commands">4.7.6.1.2. External “Shell Commands”</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#locating-external-commands">4.7.6.1.3. Locating  External commands</a><ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#commands-as-pathnames">4.7.6.1.3.1. Commands as pathnames</a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#commands-as-files-within-the-path-list">4.7.6.1.3.2. Commands as files within the PATH list</a></li>
</ul>
</li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#executing-external-commands-creating-processes">4.7.6.1.4. Executing External commands (Creating Processes)</a><ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#the-birth-of-processes">4.7.6.1.4.1. The Birth of Processes</a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#fork-exec">4.7.6.1.4.2. Fork-Exec</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-optionally-wait-for-command-to-complete">4.7.7. Step 5: Optionally wait for command to complete</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#synchronous">4.7.7.1. Synchronous</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exit-status">4.7.7.2. Exit Status</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#asynchronous-background-commands">4.7.7.3. Asynchronous (background) commands</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-6-print-prompt-if-interactive">4.7.8. Step 6: Print prompt if interactive</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#interactive-mode">4.7.8.1. Interactive Mode</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#non-interactive-mode-script-mode">4.7.8.2. Non-Interactive Mode (Script Mode)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#four-forms-of-command-lines">4.8. Four Forms of Command lines</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-commands">4.8.1. Simple Commands</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pipelines">4.8.2. Pipelines</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#a-building-block-for-composing-commands">4.8.2.1. A building block for composing commands</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#counting-wc">4.8.2.1.1. Counting (<code class="docutils literal notranslate"><span class="pre">wc</span></code>):</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#searching-grep">4.8.2.1.2. Searching  (<code class="docutils literal notranslate"><span class="pre">grep</span></code>)</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pipeline-examples">4.8.2.2. Pipeline examples</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#a-two-command-pipeline">4.8.2.2.1. A Two command pipeline</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#a-three-command-pipeline">4.8.2.2.2. A three command pipeline</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#pipelines-vs-simple-commands">4.8.2.2.3. Pipelines vs simple commands</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#list-of-commands">4.8.3. List of Commands</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sequential-list-of-commands">4.8.3.1. Sequential list of commands</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#background-asynchronous">4.8.3.2. Background / Asynchronous</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#and-list">4.8.3.3. AND list</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#or-list">4.8.3.4. OR list</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compound-commands">4.8.4. Compound Commands</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#loops">4.8.4.1. Loops</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#conditionals">4.8.4.2. Conditionals</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#groups">4.8.4.3. Groups</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#grouping">4.8.4.3.1. () grouping</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">4.8.4.3.2. {} grouping</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#user-defined-shell-functions">4.9. User defined shell Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aliases">4.10. Aliases</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#command-execution-environment">4.11. Command Execution Environment</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#process-inherited-portions">4.11.1. Process inherited Portions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#working-directory">4.11.2. Working directory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exported-shell-variables">4.11.3. Exported Shell Variables</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#open-file-descriptors">4.11.4. Open File Descriptors</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">4.12. Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#given-the-following-command-line-determine-how-it-will-be-split-into-tokens-and-which-token-is-the-command-and-which-are-the-arguments">4.12.1. Given the following command line determine how it will be split into tokens and which token is the command and which are the arguments.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#given-the-following-command-line-determine-how-many">4.12.2. Given the following command line determine how many:</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="the-shell-part-i-having-an-ascii-conversation-with-the-os">
<h1><span class="section-number">4. </span>The Shell - Part I: Having an ASCII conversation with the OS<a class="headerlink" href="#the-shell-part-i-having-an-ascii-conversation-with-the-os" title="Permalink to this heading">#</a></h1>
<p>As we read in the Unix <a class="reference internal" href="intro.html"><span class="doc std std-doc">introduction</span></a> a key feature of Unix is its command line interface that was developed for <a class="reference internal" href="terminal.html"><span class="doc std std-doc">ASCII terminals</span></a> devices. Our goal in this chapter is to understand the general model of the shell and how to start working in the terminal environment.  If you have not done so be sure to have read the sections on the Unix <span class="xref myst">Kernel</span>, <span class="xref myst">User Programs</span>, how we <span class="xref myst">visualize a running Unix system</span>, the introduction to <span class="xref myst">Terminal Emulators</span> and the chapter introducing <a class="reference internal" href="files.html"><span class="doc std std-doc">Files and Directories</span></a>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>It is a good idea to read this chapter with a terminal connection open so that you can explore the material as you read it.  Instructions and guidance on how to do this can be found in the <a class="reference internal" href="../howto.html"><span class="doc std std-doc">“How to read this book”</span></a> chapter.</p>
</div>
<section id="our-interface-to-the-kernel">
<h2><span class="section-number">4.1. </span>Our interface to the Kernel<a class="headerlink" href="#our-interface-to-the-kernel" title="Permalink to this heading">#</a></h2>
<p>As discussed the core functionality of the Unix operating system is implemented by the Kernel. However, the Kernel does not have any support for humans to directly interact with it. The primary responsibility of the kernel is to provide utilities that simplify the writing and running of application/user programs. This is where the shell comes in. The shell acts as our primary point of contact/interface, not only to the kernel, but also to all other installed programs.</p>
<section id="system-calls">
<h3><span class="section-number">4.1.1. </span>System calls<a class="headerlink" href="#system-calls" title="Permalink to this heading">#</a></h3>
<img alt="../_images/syscalls.png" src="../_images/syscalls.png" />
<p>The UNIX kernel provides a large set of functions that can be called by a running program.  Remember, on UNIX we call a running program a “process”. The kernel functions that a process can request are called “system calls”. In the next part of this book, we will look in more detail at how a process can issue a request for the kernel to execute a system call.  For the moment, it is sufficient to know that each system call, which we identify by names, can only be requested by an already running program. When a process makes a request to execute a system call, it can pass arguments to the system call. Similarly, on completion of the system call the kernel can return values back to the process. Operating system kernels can provide hundreds of system calls. In the diagram above, the white labeled boxes within the kernel oval illustrate a small subset of important UNIX kernel system calls.</p>
<p>The UNIX kernel, through its system calls, provides the ability for a process to:</p>
<ol class="arabic simple">
<li><p>create and manage files and directories</p></li>
<li><p>create and manage other processes</p></li>
<li><p>manage and work with Input and Output devices</p></li>
<li><p>communicate between processes, both on the same computer and across computers</p></li>
</ol>
<img style="float: right; margin: 0em 0em 0px 0px;" width="50%" src="../images/shellsystemcalls2.png">
A core job of the shell is to be the first running process a human user of a computer can use to interact with the kernel to get things done.  In other words, a shell has been built to let a human make use of the Operating System kernel, which itself has been written to help us make use of the computer hardware.  It does this by: 1) accepting human oriented commands from a user, 2) executing kernel system calls to get the work of the commands done, and 3) sending a response back.  The shell includes the ability to locate other executable programs and launch new processes from them.    
<p>The graphical human-computer interfaces that we use on our smart phones, laptops and desktop computers are designed to utilize touch or pointing devices (like a mouse). These interfaces allow us to find and launch programs, open files, and navigate the computer to do our daily work.  The primary goal of such interfaces is ease of use.  The shell, however, is text based, and is designed with programmers in mind.  Specifically, its syntax and commands are designed in such a way that they form an “extensible” programming language.  Here, extensible refers to the ability for users to add to and extend it with ease. This language allows a human user to not only use the facilities of the kernel, but also to automate their daily tasks, and efficiently conduct the various forms of data processing programmers often do.</p>
</section>
</section>
<section id="bash">
<h2><span class="section-number">4.2. </span>Bash<a class="headerlink" href="#bash" title="Permalink to this heading">#</a></h2>
<p>Over the years, there have been many variants of the shell program that have been developed not only for Unix, but other operating systems as well (see <a class="reference external" href="https://en.wikipedia.org/wiki/Comparison_of_command_shells">comparison of shells</a>).   While there are differences between the various Unix shell programs, the basic model of interaction we cover in this chapter is largely the same across all of them.   However, for a more detailed exploration of the shell and its syntax, we will be specifically focusing on the <a class="reference external" href="https://en.wikipedia.org/wiki/Bash_(Unix_shell)">Bourne Again Shell (BASH)</a>, as it is the default shell for Linux - the version of Unix we use throughout this book.</p>
<section id="documentation-and-manuals">
<h3><span class="section-number">4.2.1. </span>Documentation and manuals<a class="headerlink" href="#documentation-and-manuals" title="Permalink to this heading">#</a></h3>
</section>
<section id="man-bash">
<h3><span class="section-number">4.2.2. </span>man bash<a class="headerlink" href="#man-bash" title="Permalink to this heading">#</a></h3>
<p>It is a Unix tradition that programs installed on the system, like Bash, include documentation on how they are used.  To access the manual pages you use the <code class="docutils literal notranslate"><span class="pre">man</span></code> program eg. <code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">man</span></code> would bring up the documentation about the manual itself.  So <code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">bash</span></code> will bring up the manual page for the bash shell.  You can find detailed coverage of the functionality and syntax of bash in the manual.  After we cover some basics it will be much easier to read and understand the Bash manual page, as it assumes that you understand some basic UNIX and generic shell concepts.</p>
<div class="cell tag_remove-input tag_output_scroll docutils container">
</div>
<section id="info-bash">
<h4><span class="section-number">4.2.2.1. </span>info bash<a class="headerlink" href="#info-bash" title="Permalink to this heading">#</a></h4>
<a class="reference internal image-reference" href="../_images/bashinfoalone.png"><img alt="../_images/bashinfoalone.png" class="align-left" src="../_images/bashinfoalone.png" style="width: 30%;" /></a>
<p>Another really useful way to read and navigate UNIX documentation and manuals is the <a class="reference external" href="https://en.wikipedia.org/wiki/Info_(Unix)">info</a> documentation system.  Try <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">info</span></code> to learn about how to use it.  The advantage of the info system is that it provides a more friendly book like experience compared to the <code class="docutils literal notranslate"><span class="pre">man</span></code> command.  To read the info version of the <code class="docutils literal notranslate"><span class="pre">bash</span></code> documentation try <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">bash</span></code>.  To exit from info press the <code class="docutils literal notranslate"><span class="pre">q</span></code> key for quit.</p>
</section>
<section id="bash-builtin-help">
<h4><span class="section-number">4.2.2.2. </span>bash builtin <code class="docutils literal notranslate"><span class="pre">help</span></code><a class="headerlink" href="#bash-builtin-help" title="Permalink to this heading">#</a></h4>
<p>Finally, there is a built in help command to bash that we will be using throughout this chapter as well.</p>
<div class="cell tag_remove-input tag_output_scroll docutils container">
</div>
</section>
</section>
</section>
<section id="shell-session">
<h2><span class="section-number">4.3. </span>Shell Session<a class="headerlink" href="#shell-session" title="Permalink to this heading">#</a></h2>
<p>Keeping in mind that that ASCII terminals were the original devices created for humans to interactively work with computers, the shell is designed to provide a managed environment for communication with a human at a terminal. Thus, the human and the shell are really exchanging bytes of information, encoded in ASCII.  For every new terminal connection, software directs the kernel to start an instance of a shell program to interact with a user at that terminal.  We consider this to be the start of a shell “session”.  The session ends when either the communication between the shell and the terminal is disconnected, or because the user purposefully exits the shell.</p>
<section id="terminal-windows-and-the-shell">
<h3><span class="section-number">4.3.1. </span>Terminal Windows and the Shell<a class="headerlink" href="#terminal-windows-and-the-shell" title="Permalink to this heading">#</a></h3>
<p>Today, of course, we rarely use physical terminals anymore.  Rather, on our physical client computers (eg. laptops, desktops, tablets, etc) we can start many terminal emulator windows to establish a shell session for each (see below). Each session will stay active until we exit or close the session and kill the associated shell.  Since each window is connected to its own shell, they represent independent “conversations” in which we can do different things concurrently.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>The important thing is we don’t need to do anything special, simply connecting to the UNIX system via a terminal starts a shell for us to interact with.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>While you are learning how to work with bash it can be really useful to keep a terminal open in which you keep the <code class="docutils literal notranslate"><span class="pre">info</span></code> page for bash open while you use another terminal shell session to do your exploring.</p>
<img alt="../_images/screenshot-bash-info.png" src="../_images/screenshot-bash-info.png" />
</div>
</section>
</section>
<section id="line-oriented-conversation">
<h2><span class="section-number">4.4. </span>Line oriented conversation<a class="headerlink" href="#line-oriented-conversation" title="Permalink to this heading">#</a></h2>
<img style="background:white; float: left; margin: 0px 10px 0px 0px;" width="30%" src="../images/shellloopcartoon.png">
The way we interact with the shell can be thought of as a structured, interactive, "conversation". The conversation is a series of back and forth exchanges. We, the user, type in a request in the form of a "command line". In response, the shell takes some actions, and generates a particular response, as byte values, which are sent back to the terminal.  The terminal translates the response byte values into ASCII characters, displaying/printing the appropriate images of the ascii characters to the screen for the user to read.   
<section id="lines">
<h3><span class="section-number">4.4.1. </span>Lines<a class="headerlink" href="#lines" title="Permalink to this heading">#</a></h3>
<p>Given our use of ASCII encoding, the definition of a “line”, in Unix, is very precise. It is a series of byte values terminated by a single ‘new-line/line-feed’ value.  Using an ASCII  table, we see that the byte value for the new-line character is <code class="docutils literal notranslate"><span class="pre">0b10000010</span></code> in binary, or expressed more concisely in hex as <code class="docutils literal notranslate"><span class="pre">0xA</span></code>. The common shorthand notation for the newline byte value is <code class="docutils literal notranslate"><span class="pre">\n</span></code>.  Pressing the <em>return</em>  or <em>enter</em> key, depending on your keyboard, within a terminal window will generate this value.   We will simply refer to the key that generates a ‘\n’ as the <em>enter</em> key.</p>
<p>When <code class="docutils literal notranslate"><span class="pre">\n</span></code> is received by the shell, it will begin working on processing the line as a command.  In this way, we say the shell is “line oriented”.  If the user presses <code class="docutils literal notranslate"><span class="pre">\n</span></code> with no other preceding characters, it is considered a blank or empty line.</p>
<p>In the other direction, the terminal emulator is configured to take the appropriate action when it receives a <code class="docutils literal notranslate"><span class="pre">\n</span></code>.  That is to say, it moves the cursor to the next lower position in the window (scrolling if configured to do so) and moves it to the left edge of the new line (again, scrolling the window if configured to do so).</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>There are two basic modes that the UNIX kernel can use when delivering bytes sent from the terminal connection to the program running on the connection; character and line. In character mode, the bytes of data from the terminal are sent along to the running program as soon as they are received, including the <code class="docutils literal notranslate"><span class="pre">\n</span></code>.  In line (or buffered) mode, the kernel stores up the characters to be sent until a <code class="docutils literal notranslate"><span class="pre">\n</span></code> is received, at which point it sends the complete line with the <code class="docutils literal notranslate"><span class="pre">\n</span></code> to the running program. Line mode is typically the default. In the context of our discussion of the shell, this mode setting is not very relevant, as the shell’s behavior is largely unchanged by this setting. Since the shell is a line-oriented program, it is designed to process whole lines at a time - regardless of whether the line was received in its entirety, or character by character. However, it is good to keep this distinction in mind to avoid confusion when we are writing programs that are not line-oriented, and therefore expect to receive characters as soon as the keys are pressed by the user.</p>
</div>
</section>
<section id="the-prompt">
<h3><span class="section-number">4.4.2. </span>The Prompt<a class="headerlink" href="#the-prompt" title="Permalink to this heading">#</a></h3>
<img style="float: right; margin: 0px 0px 0px 10px;" width="50%" src="../images/UnixL01_SHCHT/04SHLLChat.png">
We now know that our interaction with the shell largely resembles a conversation, and similar to a conversation, we need some way to determine that the other party is ready to listen. The "prompt string," or simply, the "prompt," is the shell's way of visually telling us it is ready to talk. The prompt is a configurable sequence of characters, beginning on a new line, indicating to us that the shell is ready to recieve a line. When a new connection is established, it sends the prompt to the terminal so that we know that it is ready for the session/conversation to begin.  The classic prompt string is often either the dollar symbol, `$` or greater than sign `>` followed by a single space character.  In our illustrations, and in the default configuration we use, the prompt is set to be the classic dollar sign followed by a space.
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Today, most systems default to much more complicated prompt strings, where the prompt might state your user name, the date or time, what your current working directory is, etc.   Later, when we learn about shell variables, we will find that there is a special variable, <code class="docutils literal notranslate"><span class="pre">PS1</span></code>, whose value is used to generate the prompt string every time the shell wants to send it.  Given that every terminal session/window is connected to separate shells it can be very useful to set each with a unique prompt to help keep you organized eg. <code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">PS1='Term</span> <span class="pre">1&gt;</span> <span class="pre">'</span></code>.
If you are interested in the details use the following <code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">bash</span></code> to pull up the manual page for bash and look for the section called “Prompting”.</p>
</div>
</section>
</section>
<section id="our-first-shell-session">
<h2><span class="section-number">4.5. </span>Our first shell session<a class="headerlink" href="#our-first-shell-session" title="Permalink to this heading">#</a></h2>
<p>Before we move on to a more formal examination of the shell’s operation, why don’t we poke it and see what happens?
Perhaps the simplest thing we can do is send it an empty line by pressing <em>enter</em> on its own.
We should find that the terminal will move to the next line, and display the prompt again.
It may seem silly to examine such a simple exchange, but if we take a moment to think carefully about what is going on behind the scenes, we will find a new level of understanding that will help us to build a more complete mental model of how the shell and terminal interact.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>What happens after we press and release the <em>enter</em> key? The terminal sends - through the Unix kernel - a byte destined to the instance of the shell program that our terminal is virtually connected to.  Precisely, it sends the binary pattern <code class="docutils literal notranslate"><span class="pre">0b00001010</span></code> or in hex <code class="docutils literal notranslate"><span class="pre">0xa</span></code> as the left most sub-figure (A) illustrates.  The <span class="xref myst">figure</span> shows both the <code class="docutils literal notranslate"><span class="pre">\n</span></code> human-readable ASCII symbol, and the underlying byte value.  In other diagrams we might stop showing the byte values and only show the ASCII human-readable symbol.  It is, however, important to remember that under the covers, the terminal and shell are really just exchanging raw binary values that use the ASCII standard to encode the data.  If we were to use special device, such as a <a class="reference external" href="https://en.wikipedia.org/wiki/Logic_analyzer">logic analyzer</a>, to peek at the electical wires that make up the pathways that are transmitting data back and forth between the computer and the terminal, we would find electrical values that represent the binary encoding of the characters being exchanged.</p>
<p>The middle figure (B), is a cartoon depiction of the shell’s behavior after receiving the blank line. As we have seen, it is programmed to do “nothing”, simply sending the prompt back to the terminal to notify the user that it - the shell - is ready for another command line to be sent.  If you are interested in why the terminal displays a <code class="docutils literal notranslate"><span class="pre">\n</span></code>, causing the prompt sent by the shell to be on the next line of the terminal, read the fyi ECHO box below.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><strong>ECHO</strong>: You might be wondering why it is that the characters you type at the keyboard of the terminal appear on the screen of the terminal as well.  We now know that pressing a key sends the data to the Unix kernel, and then to the program running (such as the shell). However, no part of this exchange offers any reason why we would see these characters. Does the shell send back a copy of what it receives?  No, it does not.</p>
<p>Rather, it is the UNIX kernel that is typically configured, by default, to send a copy of what it receives on a specific terminal connection back to the terminal itself.  This setting is called terminal ECHO mode.  So by default, even before the Kernel sends data up to the destination program, it sends a copy back to the terminal so that the user can see what they typed.  This includes the <code class="docutils literal notranslate"><span class="pre">\n</span></code> that the user presses to indicate the end of the command line.  Hence, in this default mode, any data sent back as the result of an action taken by the shell will appear on a new line.  Programs can ask the kernel to disable this setting to have more control of what the user sees.</p>
<p>As a matter of fact, consistent with the style of Unix, there is a command you can issue to have the kernel adjust the setting for your terminal connection, including turning off the echo behavior (<code class="docutils literal notranslate"><span class="pre">stty</span> <span class="pre">-echo</span></code> to turn off and <code class="docutils literal notranslate"><span class="pre">stty</span> <span class="pre">echo</span></code> to turn back on).  Doing so lets you observe what is really being sent back in response to your command, and not what the kernel automatically generates as echo data.  Note, things might get confusing quickly if you turn echo off.  But Unix is all about understanding how things work, and taking advantage of the power to control them.  If you want to know more, try <code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">stty</span></code> - but be warned, you will find that communicating via a terminal is actually quite a bit more complex than it might seem. There is a lot of history, and with history come and skeletons buried here and there, and the kernel is <em>cooking</em> the communications quite a bit ;-)</p>
</div>
</section>
<section id="command-lines">
<h2><span class="section-number">4.6. </span>Command lines<a class="headerlink" href="#command-lines" title="Permalink to this heading">#</a></h2>
<p>UNIX command lines can get quite complex. As a matter of fact, one of the hallmarks of UNIX expertise is the ability to compose long command lines that chain together many commands.  Such ability develops in time as you get familar working with the shell, and like any other ability, building expertise starts with the small steps. Learning to issue simple command lines is the first step to ruling the UNIX world.</p>
<p>The simplest command lines, other than the <span class="xref myst">blank command line</span>, are composed of a single “word”.  The following are three examples of single word command lines, using the commands: <code class="docutils literal notranslate"><span class="pre">help</span></code>, <code class="docutils literal notranslate"><span class="pre">pwd</span></code> and <code class="docutils literal notranslate"><span class="pre">ls</span></code>.</p>
<section id="three-simple-examples">
<h3><span class="section-number">4.6.1. </span>Three simple examples<a class="headerlink" href="#three-simple-examples" title="Permalink to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">help</span></code> command is a “builtin” command that will provide you some help :-)</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">pwd</span></code> command is a builtin command that prints the shell’s current working directory.  We will discuss what the working directory is a little <span class="xref myst">later</span>.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">ls</span></code> command is a standard UNIX external command that lists the contents of a directory.  As we will find out later, <code class="docutils literal notranslate"><span class="pre">ls</span></code> is a very powerful command that lets us explore the existing directories and files.</p>
<div class="cell tag_remove-input docutils container">
</div>
</section>
</section>
<section id="command-line-processing">
<h2><span class="section-number">4.7. </span>Command line processing<a class="headerlink" href="#command-line-processing" title="Permalink to this heading">#</a></h2>
<!-- produced by: 
htmlFig("[{'src': '../images/shellexecuteflowchart.png', 'bgcolor': 'white', 'border': '1px solid green'}]", 
        id="fig:flowchart", 
        align="right", 
        width="65%",
        margin="1em auto 1em 1em",
        caption="Figure: Flow chart of command line processing steps.", 
        captionalign="left")
-->
<table id="fig:flowchart" align="right" width="65%" cellpadding="0" cellspacing="0" border="0" style="border-collapse: collapse; margin: 1em auto 1em 1em">
    <tr style="padding: 0; margin: 0;"> 
        <td colspan="1" width="100%" style="padding: 0; margin: 0 0 0 0; background-color:white;">
            <div style="padding: 0; margin: 0 0 0 0;">
              <figure style="padding: 0; margin: 0 0 0 0; width:100%;border: 1px solid green;">
                   <img src="../images/shellexecuteflowchart.png" width="100%" style="padding: 0; margin: 0;">
                </figure>
            </div>
        </td>
    </tr>
    <caption align="bottom" style="text-align: left; padding: 0; margin: 0;" >
          <i>Figure: Flow chart of command line processing steps.</i> 
    </caption>
</table>
<p>When the shell receives a command line, it goes through a series of steps to process it.  The rules of this processing define what is called the <a class="reference external" href="https://man7.org/linux/man-pages/man1/bash.1.html#SHELL_GRAMMAR">Shell Grammar</a>.  The Shell Grammar and builtin commands form an entire programming language.  Programs written in this language are called Shell Scripts, and are used extensively to automate all sorts of tasks.  Over the years, one learns more and more subtle aspects of the shell grammar and its usage. While it is possible to use the shell without knowing its underlying grammar, having a working knowledge can really help in understanding why the shell behaves the way it does, and in demystifying its somewhat strange syntax.</p>
<p>The <span class="xref myst">figure</span> on the right illustrates the flow of command line processing.  We will be working our way through the various steps in this section.</p>
<section id="interactive-vs-non-interactive-scripts">
<h3><span class="section-number">4.7.1. </span>Interactive vs non-interactive (scripts)<a class="headerlink" href="#interactive-vs-non-interactive-scripts" title="Permalink to this heading">#</a></h3>
<p>There are two ways in which we can use the shell: interactively or non-interactively. In either case, the core operation of the shell is unchanged – processing command lines.  The difference lies in the source of the commands processed by the shell. In the interactive mode, the commands are coming from a human through a terminal connection. In non-interactive mode, rather than a human typing the command lines at a terminal, the commands are read from a file. In the interactive case, after each command line is executed the shell sends the prompt to the human and waits for them to send the next command line.  In non-interactive mode, the command lines are being read from a shell script file.  A shell script is simply a file containing several shell command lines. In this mode, the command lines in the file are immediately executed one after the other, bypassing the need for the shell to prompt or wait.</p>
<p>While our focus in this chapter is interactive use of the shell, our understanding of how command lines are processed applies equally to writing and executing shell scripts.</p>
</section>
<section id="overview-the-six-steps-of-command-line-processing">
<h3><span class="section-number">4.7.2. </span>Overview: The six steps of command line processing<a class="headerlink" href="#overview-the-six-steps-of-command-line-processing" title="Permalink to this heading">#</a></h3>
<p>In the remainder of this chapter, we will build up our working knowledge of how the shell processes command lines and grammar.  Let’s begin by breaking down command line processing into the following six steps:</p>
<ol class="arabic simple">
<li><p>Splitting: break up (split) the line into “blank” separated words (computer scientists also call these tokens)</p></li>
<li><p>perform expansions</p></li>
<li><p>parse redirections</p></li>
<li><p>execute simple commands</p></li>
<li><p>optionally wait for command to complete</p></li>
<li><p>print prompt and wait for new command line if in interactive mode</p></li>
</ol>
<p><a id="tbl:ctloperators"></a></p>
<center><em>Table Shell Control Operators</em></center>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Control Operator</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>newline</p></td>
<td><p>End of line</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>||</p></td>
<td><p>Or list operator</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>&amp;&amp;</p></td>
<td><p>And list operator</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>;</p></td>
<td><p>Sequential list operator</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>|</p></td>
<td><p>Pipe Operator</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><span class="math notranslate nohighlight">\(\&amp;\)</span></p></td>
<td><p>Background Operator</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>(</p></td>
<td><p>Subshell list begin Operator</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>)</p></td>
<td><p>Subshell list end Operator</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>;;</p></td>
<td><p>Case statement end matching Operator</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>;&amp;</p></td>
<td><p>Case statement fall through Operator</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>;;&amp;</p></td>
<td><p>Case statement continue matching Operator</p></td>
</tr>
</tbody>
</table>
</section>
<section id="step-1-breaking-down-a-command-line-into-simple-commands-and-arguments">
<h3><span class="section-number">4.7.3. </span>Step 1: Breaking down a “Command line” into Simple Commands and Arguments<a class="headerlink" href="#step-1-breaking-down-a-command-line-into-simple-commands-and-arguments" title="Permalink to this heading">#</a></h3>
<p>In this step, the shell splits the command line into a set of tokens that form “simple commands”.   Several simple commands can make up a single command line. The common boundary that separates tokens are “blanks”.  Blanks are <code class="docutils literal notranslate"><span class="pre">space</span></code> and <code class="docutils literal notranslate"><span class="pre">tab</span></code> characters (<a class="reference external" href="https://man7.org/linux/man-pages/man1/bash.1.html#DEFINITIONS">blanks</a>).   In the ASCII code, space characters are encoded with a byte value of <code class="docutils literal notranslate"><span class="pre">0x20</span></code> and a tab is encoded by <code class="docutils literal notranslate"><span class="pre">0x09</span></code>.  So, a sequence of one more of these two characters will cause the shell to split what is before the sequence and what is after the sequence into two separate tokens.</p>
<p><a id="meta_def"></a>
In addition to the blank <code class="docutils literal notranslate"><span class="pre">space</span></code> and <code class="docutils literal notranslate"><span class="pre">tab</span></code> characters, the following characters <code class="docutils literal notranslate"><span class="pre">|</span>&#160; <span class="pre">&amp;</span> <span class="pre">;</span> <span class="pre">(</span> <span class="pre">)</span> <span class="pre">&lt;</span> <span class="pre">&gt;</span> <span class="pre">newline</span></code> will also indicate the separation of tokens.  Together, these characters are known as the shell “metacharacters”.  In time, we will learn about how these characters affect the commands to be executed. Some will let us combine simple commands in various ways, while others will affect how the command is executed.</p>
<section id="command-versus-arguments">
<h4><span class="section-number">4.7.3.1. </span>Command versus Arguments<a class="headerlink" href="#command-versus-arguments" title="Permalink to this heading">#</a></h4>
<p>The first token of simple command is the name of the command to execute.  The following tokens in the set will be passed to the command as arguments.  To know where the arguments of a particular simple command end, the shell looks for one of the following “control” operators.  Notice that some of the metacharacters, <code class="docutils literal notranslate"><span class="pre">|</span> <span class="pre">&amp;</span> <span class="pre">;</span> <span class="pre">(</span> <span class="pre">)</span></code> and <code class="docutils literal notranslate"><span class="pre">newline</span></code> itself both separate tokens and terminate the tokens of simple command.  Using the control characters allows us to chain independent simple commands together.</p>
</section>
<section id="comments">
<h4><span class="section-number">4.7.3.2. </span>Comments<a class="headerlink" href="#comments" title="Permalink to this heading">#</a></h4>
<p>If a token begins with the pound character, <code class="docutils literal notranslate"><span class="pre">#</span></code>,  then it - and all the remaining tokens on the command line - are ignored.  As such, the <code class="docutils literal notranslate"><span class="pre">#</span></code> lets us add comments to what we are doing.  This will be particularly useful when we write shell scripts. Still, even throughout our interactive use of the shell we will find them to be a helpful tool (see <span class="xref myst">Command line history</span>).</p>
<p>For example. We can ignore all tokens of the command line by placing a <code class="docutils literal notranslate"><span class="pre">#</span></code> either as a token on its own at the begining of a line,</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>or by by adding to the beginning of the first token.</p>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
</div>
<p>Another example</p>
<div class="cell tag_remove-input docutils container">
</div>
</section>
<section id="simple-command-line-splitting-examples">
<h4><span class="section-number">4.7.3.3. </span>Simple Command Line Splitting examples<a class="headerlink" href="#simple-command-line-splitting-examples" title="Permalink to this heading">#</a></h4>
<p>Lets look at a few examples of command lines and see if we can distinguish the commands from the arguments.
To help us denote spaces, tabs, and newlines, we will use the following symbols respectively: <code class="docutils literal notranslate"><span class="pre">\</span> </code>, <code class="docutils literal notranslate"><span class="pre">\t</span></code> and <code class="docutils literal notranslate"><span class="pre">\n</span></code>.</p>
<ol class="arabic simple">
<li><p>Single word simple command</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>echo<span class="se">\n</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Breakdown:</p>
<ul>
<li><p>Tokens:</p>
<ol class="arabic simple">
<li><p>echo</p></li>
</ol>
</li>
<li><p>Command Name: echo</p></li>
</ul>
</li>
<li><p>Explanation:  Like our previous examples, this command line is composed of a single, simple, one-word command. In this case, the ending newline terminates both the set of tokens that form our command, and the line itself.   The command is the <code class="docutils literal notranslate"><span class="pre">echo</span></code> command.  <code class="docutils literal notranslate"><span class="pre">echo</span></code> is a bash builtin command that prints back its arguments followed by a newline (see <code class="docutils literal notranslate"><span class="pre">help</span> <span class="pre">echo</span></code>).  Given that we are not passing any additional arguments, we expect echo to simply print a blank line.</p></li>
</ul>
<div class="cell tag_remove-input docutils container">
</div>
<ol class="arabic simple" start="2">
<li><p>command with one argument</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>echo<span class="se">\ </span>hello<span class="se">\n</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Breakdown:</p>
<ul>
<li><p>Tokens:</p>
<ol class="arabic simple">
<li><p>echo</p></li>
<li><p>hello</p></li>
</ol>
</li>
<li><p>Command Name: echo</p></li>
<li><p>Arguments:</p>
<ol class="arabic simple">
<li><p>hello</p></li>
</ol>
</li>
</ul>
</li>
<li><p>Explanation: Here, our command line contains a single simple command, which is composed of two tokens seperated by a single space.  The first token is the command, and the second is the first and only argument to the command.</p></li>
</ul>
<div class="cell tag_remove-input docutils container">
</div>
<ol class="arabic simple" start="3">
<li><p>command with multiple arguments using multiple blanks as separators</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="se">\t\ </span>echo<span class="se">\ </span>hello<span class="se">\ \ </span>goodbye<span class="se">\ \t\ </span>me<span class="se">\ </span>again<span class="se">\ \t\n</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Breakdown:</p>
<ul>
<li><p>Tokens:</p>
<ol class="arabic simple">
<li><p>echo</p></li>
<li><p>hello</p></li>
<li><p>goodbye</p></li>
<li><p>me</p></li>
<li><p>again</p></li>
</ol>
</li>
<li><p>Command Name: echo</p></li>
<li><p>Arguments:</p>
<ol class="arabic simple">
<li><p>hello</p></li>
<li><p>goodbye</p></li>
<li><p>me</p></li>
<li><p>again</p></li>
</ol>
</li>
</ul>
</li>
<li><p>Explanation: Here, our command line contains a single simple command, which is composed of five tokens seperated by various combinations of spaces and tabs. To begin, we have a tab and space preceeding the first token.  Then, we have our first token, <code class="docutils literal notranslate"><span class="pre">echo</span></code>  which is our command.  The next space separates <code class="docutils literal notranslate"><span class="pre">echo</span></code> from the <code class="docutils literal notranslate"><span class="pre">hello</span></code>.  Two spaces then separate <code class="docutils literal notranslate"><span class="pre">hello</span></code> from <code class="docutils literal notranslate"><span class="pre">goodbye</span></code>.  Then, the sequence of space, tab, space separate <code class="docutils literal notranslate"><span class="pre">goodbye</span></code> from <code class="docutils literal notranslate"><span class="pre">me</span></code>.  A single space seperates <code class="docutils literal notranslate"><span class="pre">me</span></code> from <code class="docutils literal notranslate"><span class="pre">again</span></code>.  <code class="docutils literal notranslate"><span class="pre">again</span></code> is terminated as a token by the following space, tab and newline.  So, it is important to note that when the shell runs echo, the seperating blanks will be eliminated, and only the tokens will be passed to echo as individual arguments.</p></li>
</ul>
<div class="cell tag_remove-input docutils container">
</div>
<p><a id="quotes_and_splitting_sec"></a></p>
</section>
<section id="quotes-and-command-line-splitting">
<h4><span class="section-number">4.7.3.4. </span>Quotes and Command Line Splitting<a class="headerlink" href="#quotes-and-command-line-splitting" title="Permalink to this heading">#</a></h4>
<p>There are times that one might want to include spaces or tabs in an argument to a command.  For example, let’s say we want to use echo to print the following as a single argument, including the spaces (not three arguments; <code class="docutils literal notranslate"><span class="pre">hello</span></code>, <code class="docutils literal notranslate"><span class="pre">...</span></code>, and <code class="docutils literal notranslate"><span class="pre">goodbye</span></code>).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hello</span>    <span class="o">...</span>    <span class="n">goodbye</span>
</pre></div>
</div>
<p>To do this, the shell allows us to use quotes prevent the splitting of tokens. The area enclosed in either double (“”) or single (‘’) quotes will be treated as a single token.  Later, we will explore how the shell’s expansion behavior treats double and single quotes differently, and why we might choose one over the other in a given situation. However, this distinction in behavior does not apply to this example. So, to send the strings above to echo, as a single argument, we could use either of the  the following command lines.</p>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
</div>
<section id="escaping-blanks">
<h5><span class="section-number">4.7.3.4.1. </span>Escaping blanks<a class="headerlink" href="#escaping-blanks" title="Permalink to this heading">#</a></h5>
<p>For finer control of the shell’s treatment of blank characters, a shell programmer has the ability to “escape” individual blank characters. Escaped blank characters will no longer be treated like a blank, but instead will be treated like a non-blank character. To do this, we insert a backslash in front of the space or tab we want to escape.</p>
<p>For example:</p>
<div class="cell tag_remove-input docutils container">
</div>
</section>
</section>
<section id="summary">
<h4><span class="section-number">4.7.3.5. </span>Summary<a class="headerlink" href="#summary" title="Permalink to this heading">#</a></h4>
<p>The above may seem intimidating at first, but it is important to remember that the commands we utilize most often are surprisingly simple. Many of the most commonly used lines consist of one simple command, often with no arguments or, at most, a few arguments separated by single spaces. The following are examples of the kind of commands that one might typically use.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>In all of the above cases, the line splitting stage of command line processing is very simple and intuitive.</p>
<p><a id='history'></a></p>
</section>
<section id="command-line-history">
<h4><span class="section-number">4.7.3.6. </span>Command line history<a class="headerlink" href="#command-line-history" title="Permalink to this heading">#</a></h4>
<p>Bash keeps a history of all the command lines we have executed.  Learning to view and navigate this history can really help speed up our daily work, and in some cases recover lost work.  We will introduce some of the basics of using this history to help you work more efficiently. If you’d like to learn more, you can find more details about working with your bash history here:</p>
<ul class="simple">
<li><p>Using the bash history <a class="reference external" href="https://www.gnu.org/software/bash/manual/bash.html#Using-History-Interactively">https://www.gnu.org/software/bash/manual/bash.html#Using-History-Interactively</a></p></li>
<li><p>searching the history <a class="reference external" href="https://www.gnu.org/software/bash/manual/bash.html#Searching">https://www.gnu.org/software/bash/manual/bash.html#Searching</a></p></li>
<li><p>keyboard short cuts for navigating the history <a class="reference external" href="https://www.gnu.org/software/bash/manual/bash.html#Commands-For-History">https://www.gnu.org/software/bash/manual/bash.html#Commands-For-History</a></p></li>
</ul>
<p>To view the entire history we can use the history command.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>To rerun a particular command in the history, you can enter the exclamation character, <code class="docutils literal notranslate"><span class="pre">!</span></code> followed by the history number, n,  of the command line.  For example, to rerun the command numbered 2, you would do the following:</p>
<div class="cell tag_remove-input tag_output_scroll docutils container">
</div>
<p>A shortcut for the last command is <code class="docutils literal notranslate"><span class="pre">!!</span></code>. Eg</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Bash also provides methods to allow you to avoid recording commands in the history.  The defaut setting is that command lines whose first character is a space will not be included in the history, and duplicate commands will also be omitted.  (See HISTIGNORE and HISTCONTROL in the bash manual for more details on how to control and modify this behavior).  For example, if we do not want our use of the history command to “pollute” our history, we would add a space to the front of the line.  Eg.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Finally, perhaps the most important aspect for a beginner to note is the ability to use key sequences to:</p>
<ul class="simple">
<li><p>go backward in the history : <code class="docutils literal notranslate"><span class="pre">previous-history</span></code></p></li>
<li><p>go forward in the history : <code class="docutils literal notranslate"><span class="pre">next-history</span></code></p></li>
<li><p>search history backwards : <code class="docutils literal notranslate"><span class="pre">reverse-search-history</span></code></p></li>
<li><p>search history forwards : <code class="docutils literal notranslate"><span class="pre">forward-search-history</span></code></p></li>
</ul>
<p>Each of these abilities are “bound” to various key sequences.  Usually, previous and next will be mapped to your arrow keys.  If you want to learn what the default “bindings” are (what key sequences will cause one of the above abilities), you can use the following commands:</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>The above output can seem very criptic.  Here is a quick and dirty explanation.  Search the bash manual for “key bindings” for more details.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">\C</span></code> means press the control key</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">\e</span></code> means press the escape key</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-</span></code>  means that while pressing the preceding key, press and release the next key listed. Eg. <code class="docutils literal notranslate"><span class="pre">\C-p</span></code> means press and hold down the control key, then press and release the <code class="docutils literal notranslate"><span class="pre">p</span></code> key.</p></li>
<li><p>if there is no <code class="docutils literal notranslate"><span class="pre">-</span></code> present, then you press and release the keys as a sequence.  Eg. <code class="docutils literal notranslate"><span class="pre">\eOA</span></code> means press and release the escape key, then press and release the capital o key (<code class="docutils literal notranslate"><span class="pre">O</span></code>), followed by pressing and releasing the capital a key (<code class="docutils literal notranslate"><span class="pre">A</span></code>).</p></li>
</ul>
<p>The best way to learn more about these features, and use them to your advantage, is to play around with them! Eg. try out all of the prior commands, then use the history key binding to navigate the history and re-run some commands.</p>
</section>
</section>
<section id="step-2-perform-expansions">
<h3><span class="section-number">4.7.4. </span>Step 2: Perform Expansions<a class="headerlink" href="#step-2-perform-expansions" title="Permalink to this heading">#</a></h3>
<p>After the shell has split a command line into tokens, it performs “expansion” on the tokens.  An expansion is the substitution of some parts of a token with various other values. To identify which tokens require expansion, and which type of expansion to perform, the shell looks for specific special control characters.</p>
<p>Expansions are a powerful tool in the hands of a command line programmer, but they can seem unfamiliar and overwhelming at first glance. To start, we will focus on understanding the three most common types of expansions.  In time, as you gain a greater familiarity with the shell, we encourage you to explore others.</p>
<p>See the introduction paragraphs here <a class="reference external" href="https://man7.org/linux/man-pages/man1/bash.1.html#EXPANSION">https://man7.org/linux/man-pages/man1/bash.1.html#EXPANSION</a>, and here <a class="reference external" href="https://www.gnu.org/software/bash/manual/bash.html#Shell-Expansions">https://www.gnu.org/software/bash/manual/bash.html#Shell-Expansions</a> for and more detailed overview.</p>
<section id="nine-command-line-expansions">
<h4><span class="section-number">4.7.4.1. </span>Nine Command line Expansions<a class="headerlink" href="#nine-command-line-expansions" title="Permalink to this heading">#</a></h4>
<p>Below is a brief overview of all nine expansions, and our recommendations on the priority order in which you may want to explore them.</p>
<section id="brace-expansion">
<h5><span class="section-number">4.7.4.1.1. </span>Brace Expansion<a class="headerlink" href="#brace-expansion" title="Permalink to this heading">#</a></h5>
<ul class="simple">
<li><p>Priority: You can wait to learn this one.</p></li>
<li><p>References:</p>
<ul>
<li><p><a class="reference external" href="https://man7.org/linux/man-pages/man1/bash.1.html#EXPANSION">https://man7.org/linux/man-pages/man1/bash.1.html#EXPANSION</a> (see <em>Brace Expansion</em>)</p></li>
<li><p><a class="reference external" href="https://www.gnu.org/software/bash/manual/bash.html#Brace-Expansion">https://www.gnu.org/software/bash/manual/bash.html#Brace-Expansion</a></p></li>
</ul>
</li>
<li><p>Synopsis: Provides the ability to expand a “template” token in to multiple tokens.</p></li>
<li><p>Examples:</p></li>
</ul>
<div class="cell tag_remove-input docutils container">
</div>
</section>
<section id="tilde-expansion">
<h5><span class="section-number">4.7.4.1.2. </span>Tilde Expansion<a class="headerlink" href="#tilde-expansion" title="Permalink to this heading">#</a></h5>
<ul class="simple">
<li><p>Priority: <strong>Simple and worth knowning</strong></p></li>
<li><p>Synopsis: Expands the tilde (<code class="docutils literal notranslate"><span class="pre">~</span></code>) into the path of your <span class="xref myst">home directory</span>.  In time, you will be navigating and moving through various directories, and it proves very useful to have a shortcut to the path of your home directory.</p></li>
<li><p>References: <a class="reference external" href="https://www.gnu.org/software/bash/manual/bash.html#Tilde-Expansion">https://www.gnu.org/software/bash/manual/bash.html#Tilde-Expansion</a>, <a class="reference external" href="https://man7.org/linux/man-pages/man1/bash.1.html#EXPANSION">https://man7.org/linux/man-pages/man1/bash.1.html#EXPANSION</a> (see <em>Tilde Expansion</em>)</p></li>
<li><p>Examples:</p></li>
</ul>
<div class="cell tag_remove-input docutils container">
</div>
</section>
<section id="parameter-and-variable-expansion">
<h5><span class="section-number">4.7.4.1.3. </span>Parameter and Variable Expansion<a class="headerlink" href="#parameter-and-variable-expansion" title="Permalink to this heading">#</a></h5>
<ul class="simple">
<li><p>Priority: <strong>Important to know basics</strong> - the rest can wait till later</p></li>
<li><p>Synopsis: Like  programming languages, the shell supports the notion of a variable that is identified by a “name” and has a “value”.  Shell variables are actually a special case, and a subset of a what are called “shell parameters”. We will focus specifically on variables for now. The shell provides certain, special, built-in variables such as “RANDOM” - whose value expands to a random number. Later, we will come to know and utilize another very important built-in - the “PATH” variable.  There are several ways that we can introduce our own variables, and assign them a value.  The simplest is a command line of the form:  <code class="docutils literal notranslate"><span class="pre">name=value</span></code>.   During Parameter Expansion, the <code class="docutils literal notranslate"><span class="pre">$</span></code> followed by name, will trigger parameter expansion (optionally, the name can be enclosed in braces <code class="docutils literal notranslate"><span class="pre">{name}</span></code>).  The token will then be expanded to the value if the named variable exists. Otherwise the token will be simply removed.  The shell provides all kinds of fancy ways of manipulating and transforming the value of a variable during expansions, such as deleting or substituting portions, but we will leave that for later.  Finally, shell variables can have attributes associated with them.   One important attribute marks a variable as exported.  We will see later that exported variables are passed to new programs as part of their initial “environment”.</p></li>
<li><p>References:</p>
<ul>
<li><p><a class="reference external" href="https://man7.org/linux/man-pages/man1/bash.1.html#PARAMETERS">https://man7.org/linux/man-pages/man1/bash.1.html#PARAMETERS</a></p></li>
<li><p><a class="reference external" href="https://man7.org/linux/man-pages/man1/bash.1.html#EXPANSION">https://man7.org/linux/man-pages/man1/bash.1.html#EXPANSION</a> (see <em>Parameter Expansion</em>)</p></li>
<li><p><a class="reference external" href="https://www.gnu.org/software/bash/manual/bash.html#Shell-Parameters">https://www.gnu.org/software/bash/manual/bash.html#Shell-Parameters</a></p></li>
<li><p><a class="reference external" href="https://www.gnu.org/software/bash/manual/bash.html#Shell-Parameter-Expansion">https://www.gnu.org/software/bash/manual/bash.html#Shell-Parameter-Expansion</a></p></li>
</ul>
</li>
<li><p>Examples:</p></li>
</ul>
<div class="cell tag_remove-input docutils container">
</div>
</section>
<section id="command-substitution">
<h5><span class="section-number">4.7.4.1.4. </span>Command Substitution<a class="headerlink" href="#command-substitution" title="Permalink to this heading">#</a></h5>
<ul class="simple">
<li><p>Priority: useful but you can wait to learn about it</p></li>
<li><p>Synopsis: You can specify that the output of a command should be subsituted for its name.  To trigger this behaviour, like parameter expansion, you use the dollar character <code class="docutils literal notranslate"><span class="pre">$</span></code> but follow it with the command to run enclosed in brackets eg. <code class="docutils literal notranslate"><span class="pre">$(command)</span></code>.</p></li>
<li><p>References:</p>
<ul>
<li><p><a class="reference external" href="https://man7.org/linux/man-pages/man1/bash.1.html#EXPANSION">https://man7.org/linux/man-pages/man1/bash.1.html#EXPANSION</a> (see <em>Command Substitution</em>)</p></li>
<li><p><a class="reference external" href="https://www.gnu.org/software/bash/manual/bash.html#Command-Substitution">https://www.gnu.org/software/bash/manual/bash.html#Command-Substitution</a></p></li>
</ul>
</li>
<li><p>Examples:</p></li>
</ul>
<div class="cell tag_remove-input docutils container">
</div>
</section>
<section id="arithmetic-expansion">
<h5><span class="section-number">4.7.4.1.5. </span>Arithmetic Expansion<a class="headerlink" href="#arithmetic-expansion" title="Permalink to this heading">#</a></h5>
<ul class="simple">
<li><p>Priority: Low. Useful for doing simple math and writing loops which we will cover later.</p></li>
<li><p>Synopsis: Bash supports evaluation of basic arithmetic expressions as part of the expansions it performs.  To trigger this expansion, you must enclose the expression in double round brackets, prefixed by the <code class="docutils literal notranslate"><span class="pre">$</span></code> character.  Eg. <code class="docutils literal notranslate"><span class="pre">$((expression))</span></code>.  Two particularly nice features are the support for bitwise operators, and for arbitrary bases.  Knowing how to use these features allows you to quickly calculate base conversions, and use bitwise operators to express values.</p></li>
<li><p>References</p>
<ul>
<li><p><a class="reference external" href="https://man7.org/linux/man-pages/man1/bash.1.html#EXPANSION">https://man7.org/linux/man-pages/man1/bash.1.html#EXPANSION</a> (see <em>Arithmetic Expansion</em>)</p></li>
<li><p><a class="reference external" href="https://man7.org/linux/man-pages/man1/bash.1.html#ARITHMETIC_EVALUATION">https://man7.org/linux/man-pages/man1/bash.1.html#ARITHMETIC_EVALUATION</a></p></li>
<li><p><a class="reference external" href="https://www.gnu.org/software/bash/manual/bash.html#Arithmetic-Expansion">https://www.gnu.org/software/bash/manual/bash.html#Arithmetic-Expansion</a></p></li>
<li><p><a class="reference external" href="https://www.gnu.org/software/bash/manual/bash.html#Shell-Arithmetic">https://www.gnu.org/software/bash/manual/bash.html#Shell-Arithmetic</a></p></li>
</ul>
</li>
<li><p>Examples:</p></li>
</ul>
<div class="cell tag_remove-input docutils container">
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>While Bash lets us express values in arbitrary bases as input for arithmetic expressions, it uses base ten for all expanded output values.  To get around this and display a value in a base other than 10, we can use the shell’s builtin <code class="docutils literal notranslate"><span class="pre">printf</span></code> command.  <code class="docutils literal notranslate"><span class="pre">printf</span></code> supports printing values in base 10, base 8, and importantly, base 16.  Eg.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ printf &quot;%d %o %x\n&quot; $((10#255)) $((10#255)) $((10#255))
255 377 ff
$
</pre></div>
</div>
</div>
</section>
<section id="process-substitution">
<h5><span class="section-number">4.7.4.1.6. </span>Process Substitution<a class="headerlink" href="#process-substitution" title="Permalink to this heading">#</a></h5>
<ul class="simple">
<li><p>Priority: low.</p></li>
<li><p>Synopsis:  This is a pretty subtle feature that lets you run commands, treating them as files.   To understand what this means will require us to better understand what processes and files are, and how they are represented in a UNIX system.</p></li>
<li><p>References:</p>
<ul>
<li><p><a class="reference external" href="https://man7.org/linux/man-pages/man1/bash.1.html#EXPANSION">https://man7.org/linux/man-pages/man1/bash.1.html#EXPANSION</a>  (see <em>Process Substitution</em>)</p></li>
<li><p><a class="reference external" href="https://www.gnu.org/software/bash/manual/bash.html#Process-Substitution">https://www.gnu.org/software/bash/manual/bash.html#Process-Substitution</a></p></li>
</ul>
</li>
<li><p>Examples</p></li>
</ul>
<div class="cell tag_remove-input docutils container">
</div>
</section>
<section id="word-splitting-on-expansion">
<h5><span class="section-number">4.7.4.1.7. </span>Word Splitting on Expansion<a class="headerlink" href="#word-splitting-on-expansion" title="Permalink to this heading">#</a></h5>
<ul class="simple">
<li><p>Priority: low.</p></li>
<li><p>Synopsis: After the shell has done parameter expansion, command substitution, and arithmetic expansion, it will do another round of word splitting.</p></li>
<li><p>References:</p>
<ul>
<li><p><a class="reference external" href="https://man7.org/linux/man-pages/man1/bash.1.html#EXPANSION">https://man7.org/linux/man-pages/man1/bash.1.html#EXPANSION</a>  (see <em>Word Splitting</em>)</p></li>
<li><p><a class="reference external" href="https://www.gnu.org/software/bash/manual/bash.html#Word-Splitting">https://www.gnu.org/software/bash/manual/bash.html#Word-Splitting</a></p></li>
</ul>
</li>
<li><p>Examples</p></li>
</ul>
<div class="cell tag_remove-input docutils container">
</div>
</section>
<section id="filename-expansion">
<h5><span class="section-number">4.7.4.1.8. </span>Filename Expansion<a class="headerlink" href="#filename-expansion" title="Permalink to this heading">#</a></h5>
<ul class="simple">
<li><p>Priority: <strong>Important to know the basics</strong> but the subtle aspects can be left for later.</p></li>
<li><p>Synopsis:  A very useful feature of the shell is the ability to provide templates, or patterns, that will be expanded into the names of files and directories that exist and match these patterns.  The way a pattern is stated, and the way it is matched, can get quite subtle and complex. The basic use, however, is easy, and can be a huge time saver.   After the preceding expansions are done and the second round of word splitting is complete, the shell will scan what remains, looking for a special set of characters it recognizes as pattern characters.  The most useful of these is the star <code class="docutils literal notranslate"><span class="pre">*</span></code>. The star will be substituted for any sequence of characters.  As such, it is often called the “wildcard character”, since it matches anything.  The shell will then look to see if there are files or directories that match the token, substituting the patterns as necessary.  If matching names exist, then it will replace the single token with any matches found.  While this can sound complicated, in practice, the simple uses are straightforward and can be most easily understood by studying examples.  You will really want to play with this.</p></li>
<li><p>References:</p>
<ul>
<li><p><a class="reference external" href="https://man7.org/linux/man-pages/man1/bash.1.html#EXPANSION">https://man7.org/linux/man-pages/man1/bash.1.html#EXPANSION</a>  (see <em>Pathname Expansion</em> and <em>Pattern Matching</em>)</p></li>
<li><p><a class="reference external" href="https://www.gnu.org/software/bash/manual/bash.html#Filename-Expansion">https://www.gnu.org/software/bash/manual/bash.html#Filename-Expansion</a></p></li>
<li><p><a class="reference external" href="https://www.gnu.org/software/bash/manual/bash.html#Pattern-Matching">https://www.gnu.org/software/bash/manual/bash.html#Pattern-Matching</a></p></li>
</ul>
</li>
<li><p>Examples:</p></li>
</ul>
<div class="cell tag_remove-input docutils container">
</div>
</section>
<section id="quote-removal">
<h5><span class="section-number">4.7.4.1.9. </span>Quote Removal<a class="headerlink" href="#quote-removal" title="Permalink to this heading">#</a></h5>
<ul class="simple">
<li><p>Priority: simple and does what you expect</p></li>
<li><p>Synopsis:  Finally, any quotes and back-slashes that are not within quotes themselves, or escaped, will be removed.  We generally use quotes to <span class="xref myst">control word splitting</span> and expansions (see <span class="xref myst">below</span>)
This simply is the phase that removes quotes from the tokens as expected.</p></li>
<li><p>References:</p>
<ul>
<li><p><a class="reference external" href="https://man7.org/linux/man-pages/man1/bash.1.html#EXPANSION">https://man7.org/linux/man-pages/man1/bash.1.html#EXPANSION</a>  (see <em>Quote Removal</em>)</p></li>
<li><p><a class="reference external" href="https://www.gnu.org/software/bash/manual/bash.html#Quote-Removal">https://www.gnu.org/software/bash/manual/bash.html#Quote-Removal</a></p></li>
</ul>
</li>
<li><p>Examples:</p></li>
</ul>
<div class="cell tag_remove-input docutils container">
</div>
<p><a id="quotes_and_expansions_sec"></a></p>
</section>
</section>
<section id="quoting-and-expansions">
<h4><span class="section-number">4.7.4.2. </span>Quoting and Expansions<a class="headerlink" href="#quoting-and-expansions" title="Permalink to this heading">#</a></h4>
<p>Quotes let us control expansions, similar to how we could use quotes to <span class="xref myst">stop commandline splitting</span>.  If we want to make sure that no expansions or splitting occurs over a portion of our command line, we can enclose it in single quotes <code class="docutils literal notranslate"><span class="pre">'</span></code> <code class="docutils literal notranslate"><span class="pre">'</span></code>.  If we want some expansions to occur - but no splitting - then we can use double quotes <code class="docutils literal notranslate"><span class="pre">&quot;</span></code> <code class="docutils literal notranslate"><span class="pre">&quot;</span></code>.</p>
</section>
<section id="single-quotes">
<h4><span class="section-number">4.7.4.3. </span>Single quotes<a class="headerlink" href="#single-quotes" title="Permalink to this heading">#</a></h4>
<p>So, when we want a sequence of characters to be treated, as a literal, exactly as we typed them, we enclose them in single quotes.  This suppresses all splitting and expansions.</p>
<div class="cell tag_remove-input docutils container">
</div>
</section>
<section id="double-quotes">
<h4><span class="section-number">4.7.4.4. </span>Double quotes<a class="headerlink" href="#double-quotes" title="Permalink to this heading">#</a></h4>
<p>Doubles quotes provide us with a happy medium in between no quotes and single quotes.  They let us ensure that the enclosed text will be treated as a single token, however, certain expansions are still processed prior to the command being executed.  All expansions that use the <code class="docutils literal notranslate"><span class="pre">$</span></code> as a prefix will still occur.</p>
<p><a id="sec:redirections"></a></p>
</section>
</section>
<section id="step-3-parse-redirections">
<h3><span class="section-number">4.7.5. </span>Step 3: Parse Redirections<a class="headerlink" href="#step-3-parse-redirections" title="Permalink to this heading">#</a></h3>
<p>To fully understand what it means to parse redirections, we must have a more complete understanding of how commands are run, and of the UNIX I/O model – how a program can conduct input and output.   This understanding will take us a little time, as it involves concepts such as Processes, Streams and Files, and how they interrelate.  At this point, we take a simple view that we will build upon in time.</p>
<section id="processes">
<h4><span class="section-number">4.7.5.1. </span>Processes<a class="headerlink" href="#processes" title="Permalink to this heading">#</a></h4>
<p>As we proceed, our understanding of what a process is will become more and more advanced.  For the moment, our simple working definition will be defined as any running program on a system (excluding the kernel).   The shell we interact with is a process, and the commands that we run from the shell run either within the shell process, or as new processes.   We will look at this distinction in more detail when we discuss internal built-in versus external commands.   Regardless, the commands we issue run as a process.</p>
<p>The Parse Redirections step is all about controlling the source and destination of a process’s input and output.</p>
</section>
<section id="streams-standard-input-output-and-error">
<h4><span class="section-number">4.7.5.2. </span>Streams: Standard Input, Output and Error<a class="headerlink" href="#streams-standard-input-output-and-error" title="Permalink to this heading">#</a></h4>
<p>UNIX provides three default “streams” that a process can use for its input and output.  The default streams are called: Standard Input, Standard Output and Standard Error.  A process can ignore these if it wants - but most commands, by default, use these streams.  A stream is a connection to a source or destination for reading or writing bytes.  A process reads bytes from a stream via <code class="docutils literal notranslate"><span class="pre">read</span></code> calls to the kernel. Such a stream is an input stream.  Similarly, a stream that a process can write bytes to, via <code class="docutils literal notranslate"><span class="pre">write</span></code>  kernel calls, is an output stream.  As implied by the name, a stream is like a “flow” of bytes.  Reading bytes from an input stream successively gets bytes from the source it is connected to. Writing bytes to a stream successively sends more and more bytes to the connected destination.</p>
</section>
<section id="ascii-streams">
<h4><span class="section-number">4.7.5.3. </span>ASCII streams<a class="headerlink" href="#ascii-streams" title="Permalink to this heading">#</a></h4>
<p>What the bytes “mean” or what will be done with them is up to the process. Most of the daily UNIX commands we use assume ASCII line oriented data.  This means that most commands expect that the bytes they read from their standard input will be bytes that encode ASCII lines of data.  Similarly we can expect most commands to write ASCII lines of data to their standard output and error streams.</p>
<section id="standard-error">
<h5><span class="section-number">4.7.5.3.1. </span>Standard Error<a class="headerlink" href="#standard-error" title="Permalink to this heading">#</a></h5>
<p>The UNIX designers knew that it is very common to have commands produce “normal” output and “error” output.  To support this separation, they decided to make it standard that processes get both a standard output, and an error stream.</p>
<p>By convention, when a developer is creating UNIX commands, they write them to send their “normal” output to the standard out stream.   When the programmer of a command wants to send error messages or warning messages, they use the standard error stream.  This allows someone using a command to easily direct normal output to one destination, and error output to another.   Eg. they might decide they want to ignore and hide all warning messages by redirecting the error stream to a different destination.   While, for the most part, we don’t normally use this extra flexibility, there are times when it proves very handy.</p>
</section>
</section>
<section id="streams-and-files">
<h4><span class="section-number">4.7.5.4. </span>Streams and Files<a class="headerlink" href="#streams-and-files" title="Permalink to this heading">#</a></h4>
<p>But, where exactly do the bytes for a stream come from, or go to?
A common phrase that you may hear is that in UNIX everything is a file.  From this perspective, streams are connections to files that allow a command to read or write the data of the file.</p>
<p>The designers of UNIX decided that they would try and represent all locations that might serve as a source or destination of data as files.  This includes even devices - such as terminals.  To this end, the UNIX kernel represents the majority of the devices of a computer as files that a stream can be connected to.   Reading from an input stream connected to a device “file” gets data from that device.  Writing to an output stream connected to a device file sends data to the device.</p>
</section>
<section id="opening-streams-and-file-descriptors">
<h4><span class="section-number">4.7.5.5. </span>Opening streams and File Descriptors<a class="headerlink" href="#opening-streams-and-file-descriptors" title="Permalink to this heading">#</a></h4>
<p>To connect a stream, a program makes an “open” kernel call.  As part of the open call, the program passes the path name of the file to connect the stream to, and also specifies if the connection is for input or output (or both).  If successful, the kernel will establish the connection.</p>
<p>For every process, or running program, the kernel maintains a table of open streams. This table is called a file descriptor table.  Each entry in the table is either empty or not empty.  If empty, the entry does not hold a description of an open stream.  If it is not empty, then it contains the information that describes an open stream.  The kernel can then use this descriptor information to operate on the stream, eg. read or write bytes to it.</p>
<p>When an open call is made, the kernel scans the table for the next empty location and stores the descriptor information about the newly opened stream into that location.  The index of this newly populated table entry is returned back to the process.</p>
<p>Historically, these indexes are themselves called <strong>File Descriptor</strong> numbers.  All of the kernel operations on a stream - such as read and write - require a file descriptor so that the kernel knows what stream to operate on.</p>
<p>The first three  file descriptors; 0, 1, and 2 are where connections for standard input, output and error are expected to be.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The UNIX kernel also provides other operations that let a process control its file descriptors.  This includes the ability to close a file and mark a descriptor as empty via the <code class="docutils literal notranslate"><span class="pre">close</span></code> system call.  It also lets a process control its table of file descriptors via system calls such as <code class="docutils literal notranslate"><span class="pre">dup</span></code> and <code class="docutils literal notranslate"><span class="pre">dup2</span></code> that duplicate/copy table entries.</p>
</div>
</section>
<section id="terminals-and-streams">
<h4><span class="section-number">4.7.5.6. </span>Terminals and Streams<a class="headerlink" href="#terminals-and-streams" title="Permalink to this heading">#</a></h4>
<p>As we read, an ASCII terminal provides a natural way for humans to both receive and send ASCII, line-oriented data.  When we connect to a UNIX system via a new terminal, the kernel starts a shell for us, and connects its standard streams to the particular device file that represents our terminal.   When the shell writes bytes - such as the prompt - to its standard output, we see this output in the terminal that the shell is “connected” to.  Similarly, when we type characters into the terminal, the shell will receive them when it reads from its standard input.</p>
</section>
<section id="defaults">
<h4><span class="section-number">4.7.5.7. </span>Defaults<a class="headerlink" href="#defaults" title="Permalink to this heading">#</a></h4>
<p>When the shell runs a command, it establishes what the command’s standard input, output, and error streams will be connected to.  The default behavior is to connect them to the same streams that the shell is connected to.  In most cases, this will be the terminal that the shell is interacting with.   For this reason, the input and output of a command, by default, come from and go to the terminal we are working within.</p>
</section>
<section id="overriding-the-defaults">
<h4><span class="section-number">4.7.5.8. </span>Overriding the defaults<a class="headerlink" href="#overriding-the-defaults" title="Permalink to this heading">#</a></h4>
<p>Once steps 1 and 2 of command line processing have completed, the shell has identified one or more commands, along with arguments, that we want executed.   In addition to using commands and their arguments to control its behavior, the shell also gives us the ability to control where the input and output streams for a program might come from and go to.</p>
<p>As stated above, if we don’t use any of the special redirection support, then the default behavior will be used.   If, however, we use the redirection syntax, then we can have the shell control what file descriptors a command will have open, and where they will be connected to before they run.  While there are many advanced uses of the redirection syntax, basic usage is straightforward.</p>
<p>When discussing command line splitting, we introduced that <code class="docutils literal notranslate"><span class="pre">&lt;</span></code> and <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> are <a href="#meta_def">metacharacters</a>.  Their primary use is to specify redirections.  The greater than character,  <code class="docutils literal notranslate"><span class="pre">&gt;</span></code>,  is used to control output stream redirection. Conversely, the less than, <code class="docutils literal notranslate"><span class="pre">&lt;</span></code> character is used to control input stream redirection.</p>
<p>The following examples introduce the basics. See the references for details of the syntax and more advanced uses.</p>
<p>References:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://man7.org/linux/man-pages/man1/bash.1.html#REDIRECTION">https://man7.org/linux/man-pages/man1/bash.1.html#REDIRECTION</a></p></li>
<li><p><a class="reference external" href="https://www.gnu.org/software/bash/manual/bash.html#Redirections">https://www.gnu.org/software/bash/manual/bash.html#Redirections</a></p></li>
</ul>
</section>
<section id="redirection-examples">
<h4><span class="section-number">4.7.5.9. </span>Redirection Examples<a class="headerlink" href="#redirection-examples" title="Permalink to this heading">#</a></h4>
<p>In these examples we will use  the <code class="docutils literal notranslate"><span class="pre">date</span></code>, <code class="docutils literal notranslate"><span class="pre">ls</span></code>, <code class="docutils literal notranslate"><span class="pre">cat</span></code>,  and <code class="docutils literal notranslate"><span class="pre">file</span></code> commands.</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">file</span></code> command tells the “type” of the file that we specify as an argument.  We will use it to distinguish a device file from a regular file.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">cat</span></code> command, by default, when no arguments are specified, reads bytes from the standard input stream and writes them to the standard output stream.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">ls</span></code> command, as we have seen, lists the contents of the specified directory to standard output.  By default, if no arguments are given, then <code class="docutils literal notranslate"><span class="pre">ls</span></code> will list the contents of the current working directory.</p></li>
<li><p>Finally the <code class="docutils literal notranslate"><span class="pre">date</span></code> command, if no arguments are given, prints the current date and time to the standard output stream.</p></li>
</ul>
<section id="standard-output-and-redirection">
<h5><span class="section-number">4.7.5.9.1. </span>Standard output and redirection<a class="headerlink" href="#standard-output-and-redirection" title="Permalink to this heading">#</a></h5>
<p>Let’s start with the basics.  <code class="docutils literal notranslate"><span class="pre">date</span></code></p>
<div class="cell tag_remove-input docutils container">
</div>
<p>A command line of the <code class="docutils literal notranslate"><span class="pre">date</span></code> command alone displays its output to us.  But why? Further, how can we change this?</p>
<p>The <code class="docutils literal notranslate"><span class="pre">bash</span></code> process that launches the date command - as a new process - provides this new process with a copy of its open streams.  An interactive bash process that is connected to a terminal will have its streams:</p>
<ul class="simple">
<li><p>standard input stream (fd 0),</p></li>
<li><p>standard output (fd 1), and</p></li>
<li><p>standard error (fd 2)</p></li>
</ul>
<p>All of which are connected to a device file that the kernel provides to represent the terminal the <code class="docutils literal notranslate"><span class="pre">bash</span></code> process was started from.</p>
<p>As it turns out, we can use a command line to determine what files a process’s standard streams are connected to on Linux. Specifically, the following will let us determine what files are connected to the standard streams of the bash process we are interacting with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ls<span class="w"> </span>-l<span class="w"> </span>/proc/<span class="nv">$$</span>/fd/<span class="o">{</span><span class="m">0</span>..2<span class="o">}</span>
</pre></div>
</div>
<p>We will defer understanding exactly how this command line works until later, when we discuss process identifiers.</p>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
</div>
<p>Indeed, we see that it is a “character special” file.  Which is the type of special file UNIX uses to represent terminals.  With this in mind, let’s explore the standard output redirection.</p>
<p>Using the redirection syntax, the following demonstrates what happens implicitly in the default behavior.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Namely, the process that is spawned to run date inherits its standard output destination from the shell process that spawned it. Therefore, the same file that the shell process’s standard output is connected to, will be connected to the standard output of the date process.</p>
<p>Now, using what we know, we can ask the shell to set the destination for standard output to a different file.  Doing so ensures that any output the command sends to its standard output stream (fd 1) will automatically be sent to the new destination. Eg.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Notice that by providing our own path name for the destination file, the shell:</p>
<ol class="arabic simple">
<li><p>created the new file</p></li>
<li><p>ran the date command in a new process with the new file connected to the process’s standard output</p></li>
</ol>
<p>As a result, we don’t see any output from <code class="docutils literal notranslate"><span class="pre">date</span> <span class="pre">&gt;</span> <span class="pre">mydate</span></code>.  Instead, we see that the new file exists, and we assume it contains the output from running <code class="docutils literal notranslate"><span class="pre">date</span></code>.  To confirm this, we can use the <code class="docutils literal notranslate"><span class="pre">cat</span></code> command.  Passing file names as arguments to <code class="docutils literal notranslate"><span class="pre">cat</span></code> causes it to open the specified files, and copy their contents to standard output.</p>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
</div>
<p>Which means that the above is the equivalent to:</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>As you can see, given that “everything is a file”, the <code class="docutils literal notranslate"><span class="pre">cat</span></code> command - which simply copies bytes to its standard output - becomes very powerful given redirection.</p>
<p>Using redirection, how could we copy the contents of <code class="docutils literal notranslate"><span class="pre">mydate</span></code> to a file called <code class="docutils literal notranslate"><span class="pre">mydate.old</span></code>?</p>
<div class="cell tag_remove-input docutils container">
</div>
<section id="appending-to-a-file">
<h6><span class="section-number">4.7.5.9.1.1. </span>Appending to a file<a class="headerlink" href="#appending-to-a-file" title="Permalink to this heading">#</a></h6>
<p>Before we go on to look at standard input redirection, let’s look at what happens if we redirect to an existing file.  When we use the <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> syntax:</p>
<ol class="arabic simple">
<li><p>If the file does not exist, the shell will create a new file and direct all output of the specified command into that file.</p></li>
<li><p>However, if the file does exist, it will open the file and truncate it’s contents before setting the file up as the standard output.   In other words, redirecting to an existing normal file will replace the file’s entire contents with the new output.</p></li>
</ol>
<p>For example:</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>However, there are times that we might want to add to the end of an existing file, rather than truncating it and replacing its contents.  To do this, we use two greater than symbols instead of one.  Eg. <code class="docutils literal notranslate"><span class="pre">date</span> <span class="pre">&gt;&gt;</span> <span class="pre">mydate</span></code>.  In this case, the shell will not truncate the file. Instead, it will open the file for appending, ensuring that the output of the new command is inserted at the current end of the file.</p>
<div class="cell tag_remove-input docutils container">
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>nocolobber:</strong> As we saw, the default behavior when we redirect output to an existing file is to truncate and replace its contents.  In other words, we silently “clobber” the file.  You can override this default behavior so that an error is reported if a redirection would “clobber” the contents of an existing file.
See <a class="reference external" href="https://www.gnu.org/software/bash/manual/bash.html#Redirecting-Output">https://www.gnu.org/software/bash/manual/bash.html#Redirecting-Output</a> and <a class="reference external" href="https://www.gnu.org/software/bash/manual/bash.html#The-Set-Builtin">https://www.gnu.org/software/bash/manual/bash.html#The-Set-Builtin</a> (specifically the -C option)</p>
</div>
</section>
</section>
<section id="standard-input-redirection">
<h5><span class="section-number">4.7.5.9.2. </span>Standard Input redirection<a class="headerlink" href="#standard-input-redirection" title="Permalink to this heading">#</a></h5>
<p>Similar to standard output redirection, we can also ask the shell to override the file that is connected to a command’s standard input stream (fd 0).  The symbol we use for this is the less than character <code class="docutils literal notranslate"><span class="pre">&lt;</span></code>.</p>
<p>For these examples, we need to now look more carefully at how UNIX programs deal with input.    When we provide no arguments to <code class="docutils literal notranslate"><span class="pre">cat</span></code> it will read bytes from standard input and send its contents to standard output.  Given what we know then we can copy bytes from our terminal connection to a file by simply running.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Now any line we send from the terminal, connected to the standard input of <code class="docutils literal notranslate"><span class="pre">cat</span></code>, will be copied to its standard output, which again is the terminal.  As such we see a copy of the line back on the terminal.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Now every line we type will continue to be sent to <code class="docutils literal notranslate"><span class="pre">cat</span></code> and hence get sent back to the terminal</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>To end the <code class="docutils literal notranslate"><span class="pre">cat</span></code> process, and return back to interacting with the shell, we must ask the kernel to simulate an “end of file”.  To do this, we can press the <code class="docutils literal notranslate"><span class="pre">control</span></code> key and <code class="docutils literal notranslate"><span class="pre">d</span></code> at the terminal (‘ctrl-d’).  This tells the kernel to signal to <code class="docutils literal notranslate"><span class="pre">cat</span></code> that its standard input stream is at its end. This, in turn, causes <code class="docutils literal notranslate"><span class="pre">cat</span></code> to exit, allowing us to continue interacting with <code class="docutils literal notranslate"><span class="pre">bash</span></code>.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>So, using redirection, we can employ <code class="docutils literal notranslate"><span class="pre">cat</span></code> to send data from our terminal to a file.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Conversely, we can use <code class="docutils literal notranslate"><span class="pre">cat</span></code> and redirection to send the data from the file back to the terminal.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>And, of course, use <code class="docutils literal notranslate"><span class="pre">cat</span></code> append to the file</p>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
</div>
<p>Finally, we can combine both input and output redirection to copy regular files.</p>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
</div>
<p>We can specify basic redirection in any order we like.</p>
<div class="cell tag_remove-input docutils container">
</div>
</section>
<section id="pipes">
<h5><span class="section-number">4.7.5.9.3. </span>Pipes<a class="headerlink" href="#pipes" title="Permalink to this heading">#</a></h5>
<p>The UNIX kernel provides another very powerful model for using redirection: pipes. The basic idea is to allow the output from one running program to be connected to the input of another running program. Given what we learned about the UNIX model so far, it may be no surprise that a pipe is a file. Specifically, it is a kernel-provided special file that combines the input and output redirection of two processes.</p>
<p>The shell offers special syntax for exploiting pipes, including syntax to start and connect several programs to form a chain of processes. We call the resulting chain of processes a “pipeline”.  Pipelines are a hallmark of the UNIX command line environment, and we discuss them more detail in the <span class="xref myst">Pipelines</span> section.</p>
</section>
<section id="standard-error-redirection">
<h5><span class="section-number">4.7.5.9.4. </span>Standard Error redirection<a class="headerlink" href="#standard-error-redirection" title="Permalink to this heading">#</a></h5>
<p>Shells also typically permit you to independently redirect standard error from standard output.  In <code class="docutils literal notranslate"><span class="pre">bash</span></code>, this can be accomplished by the more general syntax <code class="docutils literal notranslate"><span class="pre">n&gt;</span></code>, where <code class="docutils literal notranslate"><span class="pre">n</span></code> is a file descriptor number.   Using this syntax, we can redirect standard error with <code class="docutils literal notranslate"><span class="pre">2&gt;</span></code></p>
<p>For example, lets assume that the file <code class="docutils literal notranslate"><span class="pre">foo</span></code> does not exist.  When we run <code class="docutils literal notranslate"><span class="pre">cat</span> <span class="pre">foo</span> <span class="pre">mydate</span></code>, <code class="docutils literal notranslate"><span class="pre">cat</span></code> will send an error message to standard error stating that the file <code class="docutils literal notranslate"><span class="pre">foo</span></code> does not exist, before proceeding to open <code class="docutils literal notranslate"><span class="pre">mydate</span></code> and send its contents to standard output.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>To redirect the error output to an separate file, we can use the following:</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Similarly, we can append using <code class="docutils literal notranslate"><span class="pre">n&gt;&gt;</span></code>.</p>
<div class="cell tag_remove-input docutils container">
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>In addition to the devices files that represent hardware such as terminals, printers, etc., the kernel also provides some really useful special files that we can use.  Here are a few: 1)<code class="docutils literal notranslate"><span class="pre">/dev/null</span></code> - anything written to this file is thrown away.  This can be really useful when you want to silence the output of a command. 2) <code class="docutils literal notranslate"><span class="pre">/dev/zero</span></code> - This file is an infinite stream of zero valued bytes. 3)<code class="docutils literal notranslate"><span class="pre">/dev/random</span></code> - This file is an infinite stream of random valued bytes. In time, you will find that such files - combined with standard UNIX commands and redirection - provide many powerful utilities.</p>
</div>
</section>
</section>
</section>
<section id="step-4-execute-the-command">
<h3><span class="section-number">4.7.6. </span>Step 4: Execute the command<a class="headerlink" href="#step-4-execute-the-command" title="Permalink to this heading">#</a></h3>
<p>Once we reach step 4 of command line processing, the shell will have:</p>
<ol class="arabic simple">
<li><p>identified the names of commands to be executed</p></li>
<li><p>identified a set of arguments, if any, to pass to the commands</p></li>
<li><p>determined how to direct the input and output streams of the command(s)</p></li>
</ol>
<p>As an example, consider the following command line:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ls<span class="w"> </span>/etc<span class="w"> </span>&gt;<span class="w"> </span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span>/etc.txt<span class="w"> </span>
</pre></div>
</div>
<p>At the start of step 4, the above will have been broken down into the execution of a single command:</p>
<ul>
<li><p><strong>command name:</strong> ls</p></li>
<li><p><strong>arguments:</strong></p>
<ol class="arabic simple">
<li><p>/etc</p></li>
</ol>
</li>
<li><p><strong>redirections:</strong></p>
<ul>
<li><p><strong>standard out:</strong> /home/jovyan/etc.txt</p>
<p>Where <code class="docutils literal notranslate"><span class="pre">${HOME}</span></code> triggered variable expansion.  The value of the <code class="docutils literal notranslate"><span class="pre">HOME</span></code> shell variable is the path name of the users home directory.  In our case, it happens to be <code class="docutils literal notranslate"><span class="pre">/home/jovyan</span></code>.  This could be a different value depending on the UNIX system you are on, and your user name.</p>
</li>
</ul>
</li>
</ul>
<p>The goal now is to  “execute” the command, passing the arguments with the appropriate redirection setup.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The way this step works is critical to the flexibility and power the shell provides. It is why, as a programmer, you can easily extend and customize the UNIX command line environment with the programs and scripts you write.</p>
</div>
<p>Let’s recall the flow chart of command line processing, focusing now on the sub-steps of command execution.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Let’s take a closer look at our example command line. The following is an outline of how execution would proceed in terms of the flowchart of sub-steps.</p>
<ul>
<li><p><em>DECISION 1:</em>  The command name <code class="docutils literal notranslate"><span class="pre">ls</span></code> does not have a <code class="docutils literal notranslate"><span class="pre">/</span></code> in it, so we would proceed from decision one to decision two.</p></li>
<li><p><em>DECISIONS 2 &amp; 3:</em> As it turns out, <code class="docutils literal notranslate"><span class="pre">ls</span></code> is not a user shell <code class="docutils literal notranslate"><span class="pre">function</span></code>, nor is it a <code class="docutils literal notranslate"><span class="pre">builtin</span></code> command. So, we will proceed to decision four.</p></li>
<li><p><em>DECISION 4:</em> In our case, <code class="docutils literal notranslate"><span class="pre">ls</span></code> matches the name of the file <code class="docutils literal notranslate"><span class="pre">/usr/bin/ls</span></code>. This match is found because the location <code class="docutils literal notranslate"><span class="pre">/usr/bin</span></code> is listed in our PATH variable.  As such, the command <code class="docutils literal notranslate"><span class="pre">ls</span></code> triggers step B: “execute as external command”</p></li>
<li><p><em>STEP B:</em> The shell requests the kernel to start the executable <code class="docutils literal notranslate"><span class="pre">/usr/bin/ls</span></code> as a new process.</p>
<ul class="simple">
<li><p>with <code class="docutils literal notranslate"><span class="pre">/etc</span></code> passed as the first argument to the new process and</p></li>
<li><p>with the standard output of this process being directed to a file <code class="docutils literal notranslate"><span class="pre">/home/jovyan/etc.txt</span></code>.</p></li>
</ul>
<p>Assuming all goes well, we would end up at decision 7.</p>
</li>
<li><p><em>DECISION 7:</em> By default all commands are started synchronously, so we would proceed to the final read step.</p></li>
<li><p>The shell would wait for the newly created <code class="docutils literal notranslate"><span class="pre">ls</span></code> process to exit, gathering its exit status.</p></li>
</ul>
<p>At this point, we don’t know how exactly to verify the above, nor do we know the detailed meaning of each decision or step. The following is a more in depth discussion of the execution sub-steps and how they interact.</p>
<section id="builtin-vs-externals">
<h4><span class="section-number">4.7.6.1. </span>Builtin vs Externals<a class="headerlink" href="#builtin-vs-externals" title="Permalink to this heading">#</a></h4>
<p>The two core types of command execution are:</p>
<ol class="arabic simple">
<li><p>builtin  (steps A)</p></li>
<li><p>external (step B)</p></li>
</ol>
<section id="builtins">
<h5><span class="section-number">4.7.6.1.1. </span>Builtins<a class="headerlink" href="#builtins" title="Permalink to this heading">#</a></h5>
<p>Builtin commands are those that are directly part of the shell program.  In other words, the shell has a name of an internal command (builtin) that matches the command name specified.</p>
<p>Examples of these include: <code class="docutils literal notranslate"><span class="pre">help</span></code>, <code class="docutils literal notranslate"><span class="pre">echo</span></code>, <code class="docutils literal notranslate"><span class="pre">cd</span></code>, <code class="docutils literal notranslate"><span class="pre">print</span></code>.  To see what builtin commands are available, you can use the <code class="docutils literal notranslate"><span class="pre">help</span></code> command.</p>
<div class="cell tag_output_scroll tag_remove-input docutils container">
</div>
<p>As stated in the output of the help command, you can use <code class="docutils literal notranslate"><span class="pre">help</span> <span class="pre">&lt;cmd&gt;</span></code> to get more information about a particular command.</p>
<div class="cell tag_remove-input docutils container">
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Note, the help command also points you to other great resources (the <code class="docutils literal notranslate"><span class="pre">info</span></code> and <code class="docutils literal notranslate"><span class="pre">man</span></code> commands)</p>
</div>
</section>
<section id="external-shell-commands">
<h5><span class="section-number">4.7.6.1.2. </span>External “Shell Commands”<a class="headerlink" href="#external-shell-commands" title="Permalink to this heading">#</a></h5>
<p>Perhaps one of the coolest things about the shell, and more generally UNIX, is the way everything is broken down into small building blocks.  Rather than building the majority of the UNIX commands into the shell, the designers choose to provide an easy way to automatically find and launch external programs.  As matter of fact, philosophically, the original idea was to keep the number of builtins as small as possible.</p>
<p>In this way, the shell’s scope of responsibility remains specific - to provide the syntax for interacting with a human user, and for launching additional commands as processes. Thus, the external programs that one adds to the system can each focus on adding a single new ability.  Eg. A program that lists the contents of a directory to its standard output (<code class="docutils literal notranslate"><span class="pre">ls</span></code>), a program that copies its standard input stream to its standard output stream (<code class="docutils literal notranslate"><span class="pre">cat</span></code>), a program that lists all the current processes (<code class="docutils literal notranslate"><span class="pre">ps</span></code>).<br />
This “separation of concerns” not only allows for a great deal of flexibility in adding commands, it also means that one can have several different versions of shell programs. In this case, each shell version may provide its own take on the syntax, while maintaining the ability to reuse the existing commands.</p>
<p>This separation of concerns approach empowers and encourages programmers:</p>
<ul class="simple">
<li><p>A programmer can easily grow the system by adding a new “command”</p></li>
<li><p>A programmer can tailor each new command for a given task.</p></li>
<li><p>A programmer can easily override the default commands by installing their own programs (which are found before the standard ones)</p></li>
</ul>
<p>Over the years, the flexibility of this approach and the popularity of UNIX has lead to the development of a very large set of programs that one can add to the system and treat as commands.  Although they are often referred to as <em>“Shell Commands”</em> they are not really builtin to any given shell.</p>
<p>Today, when people talk about knowing UNIX commands, they are generally referring to a set of external programs that have evolved into a standard. The following Wikipedia page documents such a list.</p>
<div class="cell tag_remove-input tag_output_scroll docutils container">
</div>
</section>
<section id="locating-external-commands">
<h5><span class="section-number">4.7.6.1.3. </span>Locating  External commands<a class="headerlink" href="#locating-external-commands" title="Permalink to this heading">#</a></h5>
<p>There are two ways to have the shell run an external file as a program:</p>
<ol class="arabic simple">
<li><p>by using the pathname of a file as the command</p></li>
<li><p>by using the name of a file that is in one of the directories listed in the value of the PATH shell variable.</p></li>
</ol>
<section id="commands-as-pathnames">
<h6><span class="section-number">4.7.6.1.3.1. </span>Commands as pathnames<a class="headerlink" href="#commands-as-pathnames" title="Permalink to this heading">#</a></h6>
<p>One way to execute an external command,  indicated by DECISION 1 on the flow chart, is to use the “path” name of the file we want to execute as a command.   Recall that <span class="xref myst">pathname</span> of a file in UNIX is a name that uses <code class="docutils literal notranslate"><span class="pre">/</span></code>’s to indicate its name within the tree of existing directories and files.  DECISION 1 is really saying that if the command name of the command line is something that “looks” like a path name, then assume that it is.  In particular, ask the kernel to start a new process from the named file.</p>
<div class="admonition-absolute-and-relative-paths admonition">
<p class="admonition-title">Absolute and Relative Paths</p>
<p><a id="sec:relativepaths"></a></p>
<p>In the prior chapter, <a class="reference internal" href="files.html"><span class="doc std std-doc">Organizing and Managing Information</span></a>, we discussed how a file is named as a pathname starting at the Root (<code class="docutils literal notranslate"><span class="pre">/</span></code>) of the directory tree.   Such paths whose names begin with <code class="docutils literal notranslate"><span class="pre">/</span></code> are called absolute paths.</p>
<p>To ease the burden of naming files, UNIX also provides what are called relative paths.  Rather than starting a path name all the way from the root of the directory tree,  a path can be named relative.  As is discussed in the <span class="xref myst">Environment</span> section, each process has associated with it a “current working directory”.  We can think of this as a pointer to a specific directory in the directory tree.  When a process asks the kernel to open or lookup a path that does not start with a leading <code class="docutils literal notranslate"><span class="pre">/</span></code> the kernel will assume that the path is relative to the process’s current working directory.</p>
<p>When we start a new terminal session, the shell  process started has its current working directory initially set to our user’s HOME directory.  Eg. For the jovyan user in our UNIX environment, it would be /home/jovyan.  The <code class="docutils literal notranslate"><span class="pre">pwd</span></code> command can be used to print what the shell’s current working directory is, and the <code class="docutils literal notranslate"><span class="pre">cd</span></code> command can be used to change it to another directory.</p>
<p>So if we use <code class="docutils literal notranslate"><span class="pre">mydir/myfile</span></code> as a shell command, the shell will ask the kernel to locate an external command.  Given the lack of a leading <code class="docutils literal notranslate"><span class="pre">/</span></code>, the kernel will assume that we are looking for a file, <code class="docutils literal notranslate"><span class="pre">myfile</span></code> in a directory called <code class="docutils literal notranslate"><span class="pre">mydir</span></code> which is under the the shell process’s current working directory.  If the working directory is <code class="docutils literal notranslate"><span class="pre">/home/jovyan</span></code>, then the full path of the file we are trying to locate would be <code class="docutils literal notranslate"><span class="pre">/home/jovyan/mydir/myfile</span></code>.</p>
<p>Notice, however, if our current working directory was <code class="docutils literal notranslate"><span class="pre">/home/jovyan/mydir</span></code> and we wanted to have the shell execute, as an external, the file <code class="docutils literal notranslate"><span class="pre">myfile</span></code> by pathname, it would not work to simply type <code class="docutils literal notranslate"><span class="pre">myfile</span></code> as the command.  DECISION 1 explicitly states that in order to treat the command name as a pathname for an external program, the command name must contain a <code class="docutils literal notranslate"><span class="pre">/</span></code>.   As it turns out, every directory in UNIX contains two hidden directories <code class="docutils literal notranslate"><span class="pre">.</span></code> and <code class="docutils literal notranslate"><span class="pre">..</span></code>.  Where <code class="docutils literal notranslate"><span class="pre">.</span></code> is a shortcut for the name of the directory and <code class="docutils literal notranslate"><span class="pre">..</span></code> is a short cut for the name of the parent of the directory.  Using this feature, we can construct a name of a file within the current working directory that contains a slash by using <code class="docutils literal notranslate"><span class="pre">./</span></code> as a prefix.  Eg. to trigger the explicit request to execute <code class="docutils literal notranslate"><span class="pre">myfile</span></code> in the current directory as an external command, we can use <code class="docutils literal notranslate"><span class="pre">./myfile</span></code>.</p>
<p>Details of how path names are decoded can be found in the “path_resolution” man page (<code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">path_resolution</span></code>).</p>
</div>
</section>
<section id="commands-as-files-within-the-path-list">
<h6><span class="section-number">4.7.6.1.3.2. </span>Commands as files within the PATH list<a class="headerlink" href="#commands-as-files-within-the-path-list" title="Permalink to this heading">#</a></h6>
<p>Using pathnames lets us ask the shell to try and execute a file as a process.  However, this is not sufficient to make execution of external programs feel like builtin commands.</p>
<p>Notice, there is another pathway in the flow chart for reaching STEP B - external command execution.  Specifically, if the command name is not a user defined function (see <span class="xref myst">Functions</span>),  or a shell builtin command, then the shell will look to see if the command is the name of a file within a set of directories.  The set of directories is the current value of the shell’s PATH variable.  Specifically, the PATH variable is treated as a colon separated list of directories to be searched for files that will be launched as external commands.  The list is searched from left to right.   If the name of the command matches the name of a file within the directory being searched, then the file will be treated as an external command and the shell will attempt to execute it.  Note, the first match will terminate the search. In the event that directories later in the path also contain a file that matches the command name, they will not be considered.</p>
<p>Notice three critical points to this design:</p>
<ol class="arabic simple">
<li><p>Files within the set of directories listed in PATH do not require use of path names to be executed.  This makes them feel more like builtin commands.  Simply adding files to one of the directories listed by the PATH variable is enough to make the program become a “command”.</p></li>
<li><p>The PATH variable is just an ordinary shell variable that can be updated anytime one likes.   It can be set to any value(s).  Thus, you can easily add directories of files to it, and/or remove directories from it. Further, remember that every terminal connection has an independent shell process connected to it, each with their own version of the PATH variable.  As such, you can override the PATH in one shell process while leaving it untouched in another.</p></li>
<li><p>By controlling the order of directories in PATH, you can override which version of a file should be launched as the command.  In this way, you can provide alternative “personalities” to the commands by providing your own versions in directories that appear before the directories with the standard versions.</p></li>
</ol>
<p>Let’s explore this in a little more detail by examining how the <code class="docutils literal notranslate"><span class="pre">cat</span></code> command gets located.  First, lets see if <code class="docutils literal notranslate"><span class="pre">cat</span></code> is a built in by asking for <code class="docutils literal notranslate"><span class="pre">help</span></code> about it.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Sure enough, <code class="docutils literal notranslate"><span class="pre">cat</span></code> does not seem to be a built in.  Let’s look at the PATH variable to see what is going on.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>We see that the PATH variable lists several directories (each directory is an independent element of the list where elements are separated by a <code class="docutils literal notranslate"><span class="pre">:</span></code>).  While we could use ls to search each element, the shell builtin command <code class="docutils literal notranslate"><span class="pre">type</span></code> has a convenient option <code class="docutils literal notranslate"><span class="pre">-a</span></code> that displays all the locations containing an executable (see <code class="docutils literal notranslate"><span class="pre">help</span> <span class="pre">type</span></code> for more details).</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>We see that there are two directories listed in the current PATH varaibles value that contain a file named <code class="docutils literal notranslate"><span class="pre">cat</span></code>.  Given that <code class="docutils literal notranslate"><span class="pre">/usr/bin</span></code> appears first in the path, from left to right, <code class="docutils literal notranslate"><span class="pre">/usr/bin/cat</span></code> is the file that will currently be executed when we use <code class="docutils literal notranslate"><span class="pre">cat</span></code> as a command name.  We can use the <code class="docutils literal notranslate"><span class="pre">-p</span></code> option to the type command to confirm this, as this option will cause type to print the file that currently will be executed.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Remember, all files in all directories of the PATH variable can be treated as commands.  The following lists all of them.</p>
<div class="cell tag_remove-input tag_output_scroll docutils container">
</div>
<p>We can use the following command to get an approximate count.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>That’s quite a lot.  One of the joys of UNIX is learning to poke around and explore.  We encourage you to explore the directories and files that you find.</p>
<p>Let’s now exploit the flexibility of the shell to provide our own version of <code class="docutils literal notranslate"><span class="pre">cat</span></code>.  For this example, we need to use a few commands and ideas that we have not yet covered. For these, a brief explanation will suffice for now, and we will go into more detail later on.</p>
<p>Let’s first begin by creating a directory within our home directory, called <code class="docutils literal notranslate"><span class="pre">mybin</span></code>, where we will place our new version of <code class="docutils literal notranslate"><span class="pre">cat</span></code>.  To do this, we will use the <code class="docutils literal notranslate"><span class="pre">mkdir</span></code> command</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Our new <code class="docutils literal notranslate"><span class="pre">cat</span></code> command will be a very simple “shell script”, which is simply a file that contains shell commands.  To do this, we will use <code class="docutils literal notranslate"><span class="pre">echo</span></code> and redirection to create the file and put the contents into it.</p>
<p>To enable the kernel to execute this file as a shell script, we will do the following:</p>
<ol class="arabic simple">
<li><p>We will use a special syntax for the first line.  This syntax will tell the kernel what program it should launch as a new process to  “interpret” the rest of the file’s lines as a script.  In our case it will be <code class="docutils literal notranslate"><span class="pre">/bin/bash</span></code>, since our script will need to be interpreted as bash command lines.</p></li>
<li><p>The second thing we must do is mark the meta-data of file as executable, so that the kernel will identify it as a file to execute.  To do this, we will use the <code class="docutils literal notranslate"><span class="pre">chmod</span> <span class="pre">+x</span></code> command.</p></li>
</ol>
<p>The second line of the file will be a simple shell command that sends a message to standard output.</p>
<p>Step 1. create the file with the first line being <code class="docutils literal notranslate"><span class="pre">#!/bin/bash</span></code></p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Add a second line to display our message to the standard output stream.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Let’s use <code class="docutils literal notranslate"><span class="pre">cat</span></code> to confirm that our file has the two lines we want in it.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Now, lets use <code class="docutils literal notranslate"><span class="pre">chmod</span> <span class="pre">+x</span></code> to mark our file as an executable.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Using <code class="docutils literal notranslate"><span class="pre">ls</span> <span class="pre">-l</span></code> we can inspect the meta-data of the our new file and confirm that it is now marked as executable.  Notice the <code class="docutils literal notranslate"><span class="pre">x</span></code>’s in the data to the left.  We will discuss file permissions in more detail later.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Ok, let’s start by trying to run our new version of cat using its path name.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Great, now let’s add our <code class="docutils literal notranslate"><span class="pre">mybin</span></code> directory to PATH and see what happens.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Let’s check to see what the path looks like now</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Let’s now try using <code class="docutils literal notranslate"><span class="pre">cat</span></code> as our command</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>But, of course, this does not work as we put the directory at the end.  Let’s see what <code class="docutils literal notranslate"><span class="pre">type</span></code> has to say.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Let’s be more careful and put our directory at be beginning of the directory list in the PATH variable.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Trying again…</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Cool!  But now, can we use the system version of <code class="docutils literal notranslate"><span class="pre">cat</span></code>? Well, we can use the full path eg. <code class="docutils literal notranslate"><span class="pre">/usr/bin/cat</span></code> or we can put PATH back to the way it was.</p>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
</div>
<div class="tip admonition">
<p class="admonition-title">Try me</p>
<p>Now, using the above as an example, try and add an external command that is a simple shell script called <code class="docutils literal notranslate"><span class="pre">hello</span></code>.  When you use <code class="docutils literal notranslate"><span class="pre">hello</span></code> as a command, the the string “Hello there!” should be printed to the standard output stream.</p>
</div>
<p><a id="sec:processcreation"></a></p>
</section>
</section>
<section id="executing-external-commands-creating-processes">
<h5><span class="section-number">4.7.6.1.4. </span>Executing External commands (Creating Processes)<a class="headerlink" href="#executing-external-commands-creating-processes" title="Permalink to this heading">#</a></h5>
<p>Now that we have seen how files can be located and treated as external commands by the shell, let’s look a little closer at how they are executed as new processes.  In order to do this, we need to take a step back and try and understand a little more about what processes and programs are, and their relationship to each other and the Operating System kernel.</p>
<section id="the-birth-of-processes">
<h6><span class="section-number">4.7.6.1.4.1. </span>The Birth of Processes<a class="headerlink" href="#the-birth-of-processes" title="Permalink to this heading">#</a></h6>
<p>In the introduction chapter we visualized a <span class="xref myst">set of processes</span>, where each was represented as a bubble above the UNIX kernel.  Each was labeled with the “program” it is running. Further, we said that each has its own “lifetime” – it gets started and can run for some arbitrary amount of time, and once that time is up it terminates eg. exits.  This is the common model for a running “App” - running on our phones, laptops, or other devices - that we have all grown accustomed to.</p>
<p>On UNIX, a running App is a process.  Remember that on UNIX a shell process is automatically started for us when we open a terminal connection. This shell process, in turn, lets us start other processes. This is surprisingly similar to the way we start a running App across operating systems, and the relationship between the initial shell process and those it spawns can be likened to the relationship between an operating system and the applications it starts. That is to say, starting a process through a shell command line and launching an app by touching or double clicking an icon, while they might feel quite different, are one in the same behind the scenes. An initial App - that we as humans interact with - lets us start other Apps.</p>
<p><em>Parent and Child Processes:</em> On UNIX processes are organized as a tree.  Processes started by another process are called children of the starting process.  Similarly, the process that started a particular process is its parent.  Parent processes can exert a certain level of control over their child processes.  We will discuss this in more detail in the next chapter.  For the moment, this should be good enough for us to understand this critical step in command line processing.</p>
<p><em>Binary Executables:</em>  We have been somewhat vague about what makes a file a “program” from which a running App can be started.   Every operating system has a very particular file format, the way the information  of a file is encoded in bytes, that makes it possible for the operating system kernel to start new running Apps from it.    Such files go by several generic names, “executables” and “binaries” are common ones.   Much of the next Part of this book is about understanding exactly what a binary executable is and how to construct one.  For the moment it is sufficient for us to know that many of the files in the directories, within our path, are properly formatted  UNIX binaries.  This means that the UNIX kernel can start processes from them.  The binary executable format used by the LINUX kernel is called “Executable and Linkable Format (ELF)”.  So binary executables on Linux are “ELF files”.</p>
<p>Using the “file” command we can confirm that both <code class="docutils literal notranslate"><span class="pre">bash</span></code> and <code class="docutils literal notranslate"><span class="pre">ls</span></code> are ELF files</p>
<div class="cell tag_remove-input docutils container">
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Binary Executable file formats: On LINUX, the binary executables conform to a file format called <a class="reference external" href="https://en.wikipedia.org/wiki/Executable_and_Linkable_Format">“Executable and Linkable Format (ELF)”</a> files.  On OSX and iOS, the file format of executables used is called <a class="reference external" href="https://en.wikipedia.org/wiki/Mach-O">“Mach-O”</a>.  On Windows, a common executable file format is <a class="reference external" href="https://en.wikipedia.org/wiki/Portable_Executable">“Portable Executable (PE)”</a>.    Another example of an executable file format is <a class="reference external" href="https://en.wikipedia.org/wiki/XCOFF">“eXtended Common Object File Format (XCOFF)”</a> that is used by IBM.  At this point, it will be hard to make sense of exactly what these files contain.  But in the next Part of this Book we will get into the details of the ELF format as we understand how to program the actual hardware of a computer.</p>
</div>
<!-- produced by: 
htmlFig("[[{'src': '../images/BashProcessExecution-Step4B.png', 'cellwidth': '100%', 'caption': 'A: Start of Steo 4B: External Command Execution.'}], [{'src': '../images/BashProcessExecution-Step4B-forkexec.png', 'cellwidth': '100%', 'caption': 'B: Shell makes calls to the kernel requesting the creation of a new process'}], [{'src': '../images/BashProcessExecution-Step4B-lsrunning.png', 'cellwidth': '100%', 'caption': 'C: New process is started running requested binary'}]]", 
        id="fig:executessteps", 
        align="left", 
        width="50%",
        margin="auto auto auto auto",
        caption="Figure: Visualizing the start of executing an external command as a process.", 
        captionalign="left")
-->
<table id="fig:executessteps" align="left" width="50%" cellpadding="0" cellspacing="0" border="0" style="border-collapse: collapse; margin: auto auto auto auto">
    <tr style="padding: 0; margin: 0;"> 
        <td colspan="1" width="100%" style="padding: 0; margin: 0 0 0 0; background-color:inherit;">
            <div style="padding: 0; margin: 0 0 0 0;">
              <figure style="padding: 0; margin: 0 0 0 0; width:100%;">
                   <img src="../images/BashProcessExecution-Step4B.png" width="100%" style="padding: 0; margin: 0;">
                  <figcaption>
                    <div style="background-color: inherit; margin-right:auto; margin-left:auto; text-align: center;">
                       <i style="color:inherit"> A: Start of Steo 4B: External Command Execution.</i>
                    </div>
                  </figcaption>
                </figure>
            </div>
        </td>
    </tr>
    <tr style="padding: 0; margin: 0;"> 
        <td colspan="1" width="100%" style="padding: 0; margin: 0 0 0 0; background-color:inherit;">
            <div style="padding: 0; margin: 0 0 0 0;">
              <figure style="padding: 0; margin: 0 0 0 0; width:100%;">
                   <img src="../images/BashProcessExecution-Step4B-forkexec.png" width="100%" style="padding: 0; margin: 0;">
                  <figcaption>
                    <div style="background-color: inherit; margin-right:auto; margin-left:auto; text-align: center;">
                       <i style="color:inherit"> B: Shell makes calls to the kernel requesting the creation of a new process</i>
                    </div>
                  </figcaption>
                </figure>
            </div>
        </td>
    </tr>
    <tr style="padding: 0; margin: 0;"> 
        <td colspan="1" width="100%" style="padding: 0; margin: 0 0 0 0; background-color:inherit;">
            <div style="padding: 0; margin: 0 0 0 0;">
              <figure style="padding: 0; margin: 0 0 0 0; width:100%;">
                   <img src="../images/BashProcessExecution-Step4B-lsrunning.png" width="100%" style="padding: 0; margin: 0;">
                  <figcaption>
                    <div style="background-color: inherit; margin-right:auto; margin-left:auto; text-align: center;">
                       <i style="color:inherit"> C: New process is started running requested binary</i>
                    </div>
                  </figcaption>
                </figure>
            </div>
        </td>
    </tr>
    <caption align="bottom" style="text-align: left; padding: 0; margin: 0;" >
          <i>Figure: Visualizing the start of executing an external command as a new process.</i> 
    </caption>
</table>
</section>
<section id="fork-exec">
<h6><span class="section-number">4.7.6.1.4.2. </span>Fork-Exec<a class="headerlink" href="#fork-exec" title="Permalink to this heading">#</a></h6>
<p>Let’s recall where we are in the flow of Processing a Command Line.  We are at <span class="xref myst">Step 4: Execute the Command, Sub-step B: request kernel to execute as external command</span>.   The figures to the left illustrate a breakdown of what happens in this sub-step.  At the start, we know the file that corresponds to the external command, the arguments to be passed to it, and any redirections that need to be established for the process that will be created.  In the example, the file is “/usr/bin/ls”, a single argument,<code class="docutils literal notranslate"><span class="pre">/etc</span></code>, is being passed to it, and no redirections have been specified.  Given the lack of redirections, we expect the standard streams of the new process to be connected to the same places that the launched <code class="docutils literal notranslate"><span class="pre">bash</span></code> process’s standard streams are connected to.</p>
<p>In the example illustrated, we see that initially we have our <code class="docutils literal notranslate"><span class="pre">bash</span></code> process, which has its standard streams connected to an external terminal.  This is represented by the thick red arrow that connects the process through the communication hardware to the outside world. In the next chapter when we visualize files within the kernel we will be more detailed on how the kernel enables this connection.</p>
<p>The core functionality of this step is illustrated in the middle sub-figure.  The <code class="docutils literal notranslate"><span class="pre">bash</span></code> process, on our behalf, makes use of two kernel system calls; 1) fork, and 2) exec.  At this point, the details of these calls are not particularly important.  What matters is that the shell passes to the <code class="docutils literal notranslate"><span class="pre">exec</span></code> system call the path of the file to be executed, along with the list of arguments, and a copy of the ‘exported’ shell variables.<br />
We will say more about the ‘exported’ shell variables when we discuss the <span class="xref myst">execution environment</span>.</p>
<p>When this sequence of calls completes, a new child process of the <code class="docutils literal notranslate"><span class="pre">bash</span></code> process will be started from the file specified, in this case <code class="docutils literal notranslate"><span class="pre">/usr/bin/ls</span></code>.  Now, as illustrated in the third and final bottom sub-figure, two processes exist; the original parent <code class="docutils literal notranslate"><span class="pre">bash</span></code> process, and its new child, the <code class="docutils literal notranslate"><span class="pre">ls</span></code> process.   This new child process will have a copy of the arguments and environment variables that were passed to the <code class="docutils literal notranslate"><span class="pre">exec</span></code> system call.  By default, its standard streams will be connected to the same locations that its parent  process’s streams were connected to when it started the child.  In our example, this is illustrated by the two red, thick, dashed arrows going to the same external connection (eg. the same external terminal).</p>
<p>At this point, the new <code class="docutils literal notranslate"><span class="pre">ls</span></code> process is running independently of its parent <code class="docutils literal notranslate"><span class="pre">bash</span></code>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><strong>Process Scheduling</strong>: It is the kernel’s job to “schedule” the current processes on the hardware of the computer so that each running program can execute some of its steps.   We will discuss this topic in more detail when we get a firmer understanding of how software and hardware interact to execute steps of a program.</p>
<p>For the moment it is sufficient to know, at a high-level, that at any given moment some processes will be running while others will be paused.   At any given time, the number of processes that can be actually executing steps of their program will be equal to the number of CPUs that the hardware has.  The kernel will keep track of all of the processes that are eligible to run (“RUNNABLE”) versus those that are waiting (“BLOCKED”) on some event.  For the RUNNABLE ones, the kernel will keep rotating which processes are using the CPUs.  For those that are blocked, eg. waiting to get input from a terminal or waiting for another process to terminate, the kernel will monitor if the event they are blocked on occurs, at which point they can be unblocked and made RUNNABLE.</p>
</div>
</section>
</section>
</section>
</section>
<section id="step-5-optionally-wait-for-command-to-complete">
<h3><span class="section-number">4.7.7. </span>Step 5: Optionally wait for command to complete<a class="headerlink" href="#step-5-optionally-wait-for-command-to-complete" title="Permalink to this heading">#</a></h3>
<p>At first this step might seem odd until you firmly grasp that a child process that gets started to run a command is really an independent process from the parent shell process we are interacting with. As such, it has its own lifetime and can run for an arbitrary amount of time.
The amount of time depends on what the command does.  Simple commands like the ones we have run so far do some specific work, like <code class="docutils literal notranslate"><span class="pre">ls</span></code>, which lists the contents of a directory, and then exit.  When a process exits, it returns an integer value, called its exit status, which the kernel stores.  The kernel provides ways for a parent process to wait for its child processes to exit and retrieve the their exit status value.  In particular, it provides a family of <code class="docutils literal notranslate"><span class="pre">wait</span></code> system calls.</p>
<p>Examining the <span class="xref myst">flow chart</span>, we see that in step 5 there are really two choices:  Synchronous and Asynchronous.</p>
<!-- produced by: 
htmlFig("[[{'src': '../images/BashProcessExecution-Step5-waitcalled.png', 'cellwidth': '100%'}], [{'src': '../images/BashProcessExecution-Step5-exitcall.png', 'cellwidth': '100%'}], [{'src': '../images/BashProcessExecution-Step5-waitreturn.png', 'cellwidth': '100%'}]]", 
        id="fig:step5", 
        align="right", 
        width="50%",
        margin="auto auto auto auto",
        caption="Figure: Step 5: Assuming normal 'Synchronous' command, then the shell waits for the new process to exit", 
        captionalign="left")
-->
<table id="fig:step5" align="right" width="50%" cellpadding="0" cellspacing="0" border="0" style="border-collapse: collapse; margin: auto auto auto auto">
    <tr style="padding: 0; margin: 0;"> 
        <td colspan="1" width="100%" style="padding: 0; margin: 0 0 0 0; background-color:inherit;">
            <div style="padding: 0; margin: 0 0 0 0;">
              <figure style="padding: 0; margin: 0 0 0 0; width:100%;">
                   <img src="../images/BashProcessExecution-Step5-waitcalled.png" width="100%" style="padding: 0; margin: 0;">
                </figure>
            </div>
        </td>
    </tr>
    <tr style="padding: 0; margin: 0;"> 
        <td colspan="1" width="100%" style="padding: 0; margin: 0 0 0 0; background-color:inherit;">
            <div style="padding: 0; margin: 0 0 0 0;">
              <figure style="padding: 0; margin: 0 0 0 0; width:100%;">
                   <img src="../images/BashProcessExecution-Step5-exitcall.png" width="100%" style="padding: 0; margin: 0;">
                </figure>
            </div>
        </td>
    </tr>
    <tr style="padding: 0; margin: 0;"> 
        <td colspan="1" width="100%" style="padding: 0; margin: 0 0 0 0; background-color:inherit;">
            <div style="padding: 0; margin: 0 0 0 0;">
              <figure style="padding: 0; margin: 0 0 0 0; width:100%;">
                   <img src="../images/BashProcessExecution-Step5-waitreturn.png" width="100%" style="padding: 0; margin: 0;">
                </figure>
            </div>
        </td>
    </tr>
    <caption align="bottom" style="text-align: left; padding: 0; margin: 0;" >
          <i>Figure: Step 5: Assuming normal 'Synchronous' command, then the shell waits for the new process to exit</i> 
    </caption>
</table>
<section id="synchronous">
<h4><span class="section-number">4.7.7.1. </span>Synchronous<a class="headerlink" href="#synchronous" title="Permalink to this heading">#</a></h4>
<p>The default behavior of the shell to start an external command as a child process, wait for it to exit and gather its exit status before going on to do anything else.  We call this step-by-step behavior, “Synchronous”.  The shell process is synchronizing what it’s going to do next with the exit of the process it launched to execute the current command.  In other words, we can’t have the shell do anything else until the current command exits as it is “stuck” waiting for it to exit.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>This is not quite true.  In the next chapter we will see how we can use something called a signal to pause the running command and get back to the shell so that we can interact with it.</p>
</div>
<p>The synchronous behavior is illustrated in our example to the right.  We see that, after launching the child process for <code class="docutils literal notranslate"><span class="pre">ls</span></code> the shell calls one of the <code class="docutils literal notranslate"><span class="pre">wait</span></code> system calls.  The kernel pauses, “blocks”, the shell process at this point.  This means that the shell will not execute any more of its steps until the kernel decides to un-pause it. In the meantime the child <code class="docutils literal notranslate"><span class="pre">ls</span></code> process can execute steps of its program which will use kernel calls to examine the directory <code class="docutils literal notranslate"><span class="pre">/etc</span></code> and print a summary of its contents to its standard output stream.  Given that in our case, no redirections were specified, the output will go to the same terminal that its parent <code class="docutils literal notranslate"><span class="pre">bash</span></code> is connected to.  When the <code class="docutils literal notranslate"><span class="pre">ls</span></code> program is complete and exits, a call to the kernel’s <code class="docutils literal notranslate"><span class="pre">exit</span></code> system call will be made.  The kernel will recognize that the <code class="docutils literal notranslate"><span class="pre">bash</span></code> process was blocked waiting its child process to exit and un-pause the <code class="docutils literal notranslate"><span class="pre">bash</span></code> process.  As part of this un-pausing the kernel will let the call <code class="docutils literal notranslate"><span class="pre">bash</span></code> made to the <code class="docutils literal notranslate"><span class="pre">wait</span></code> system call will return.</p>
</section>
<section id="exit-status">
<h4><span class="section-number">4.7.7.2. </span>Exit Status<a class="headerlink" href="#exit-status" title="Permalink to this heading">#</a></h4>
<p>When a process calls the <code class="docutils literal notranslate"><span class="pre">exit</span></code> system call it passes an integer to the kernel.  This value is called the process’s “Exit Status”.  The <code class="docutils literal notranslate"><span class="pre">wait</span></code> system call, in addition to allowing a parent to wait for a child to exit also passes the parent the exit status that the child passed to the kernel when called <code class="docutils literal notranslate"><span class="pre">exit</span></code>.</p>
<p>The shell provides a special variable that stores the exit status of the last command.  This variable has the somewhat odd name of the dollar symbol, <code class="docutils literal notranslate"><span class="pre">?</span></code>.  So right after the current command exits we can use the <code class="docutils literal notranslate"><span class="pre">?</span></code> variable to access the exit status of the command.  Given how the variable expansion works we can view the value by using the expansion syntax of <code class="docutils literal notranslate"><span class="pre">$?</span></code>.  For example</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>The UNIX convention is that programs should return an exit status of 0 when everything went smoothly and there were no errors.  Similarly if something went wrong then a program should return a non-zero value that indicates what went wrong.  The documentation for a command should state what the non-zero values mean.  For example scroll down the following man page for ls and you will see the section that documents what its exit status values mean (the section, “Exit status:” is very close to the end right above the AUTHOR information)</p>
<div class="cell tag_remove-input tag_output_scroll docutils container">
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Zombies</strong>:  An interesting scenario arises in UNIX when a child exits but its parent has not retrieved the exit status of the terminated child.  The child is not really alive, nor can it really be cleaned up, as its exit status has not been retrieved.   At this point it is a Zombie, neither alive nor fully dead!  Taking this one step further, what happens if a parent exits before it ever calls <code class="docutils literal notranslate"><span class="pre">wait</span></code> to get the exits statuses of its children?  It turns out that UNIX has a special process designed to deal with this scenario.  This process inherits all orphaned processes and calls <code class="docutils literal notranslate"><span class="pre">wait</span></code> on them to ensure that zombies get “reaped” and don’t build up!</p>
</div>
</section>
<section id="asynchronous-background-commands">
<h4><span class="section-number">4.7.7.3. </span>Asynchronous (background) commands<a class="headerlink" href="#asynchronous-background-commands" title="Permalink to this heading">#</a></h4>
<p>While running commands synchronously is the default behavior of the shell, we can also override the synchronous behavior and start commands that will run “asynchronously”.  In this case, the shell will start the command, but it will not wait for the command to finish before it goes on.  To do this, we use the shell control character <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> to terminate the command. Using this character tells the shell that the command should be run as a background “job”, and that the shell should go on to the next command immediately.  In interactive mode this means that we can go back to working with the shell immediately.</p>
<p>For example consider the following:</p>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
</div>
<p>In the examples above, we are issuing two commands, the second of which - <code class="docutils literal notranslate"><span class="pre">grep</span></code> - searches all of the files in the /opt/conda directory for the string “KillRoy.” Since there are many files to search, this command takes time to complete and return. With this in mind, we can see the effect of the control character <code class="docutils literal notranslate"><span class="pre">&amp;</span></code>.</p>
<p>In the first example, the command lines are issued consecutively, and in the absence of the control character each is run synchronously. After the first <code class="docutils literal notranslate"><span class="pre">date</span></code> command is run, the shell starts the <code class="docutils literal notranslate"><span class="pre">grep</span></code> process, and must wait for it to complete before moving on to the next <code class="docutils literal notranslate"><span class="pre">date</span></code> command. From the output of the two <code class="docutils literal notranslate"><span class="pre">date</span></code> commands, we can see the elapsed time that it took for <code class="docutils literal notranslate"><span class="pre">grep</span></code> to finish.
On the other hand, in the second example we terminate the <code class="docutils literal notranslate"><span class="pre">grep</span></code> command line with the <code class="docutils literal notranslate"><span class="pre">&amp;</span></code>, telling the shell to run it “asynchronously.” Therefore, after the shell starts the <code class="docutils literal notranslate"><span class="pre">grep</span></code> process, rather than waiting for it to return, the shell immediately continues to the next command line. We can see from output that the elapsed time between issuing each <code class="docutils literal notranslate"><span class="pre">date</span></code> command has diminished as a result.</p>
<p>Later in the chapter we will look at more advanced uses of control characters when we discuss <span class="xref myst">lists of commands</span>.</p>
<p>In the next chapter we will discuss how we can manage and control jobs and processes in more detail.</p>
</section>
</section>
<section id="step-6-print-prompt-if-interactive">
<h3><span class="section-number">4.7.8. </span>Step 6: Print prompt if interactive<a class="headerlink" href="#step-6-print-prompt-if-interactive" title="Permalink to this heading">#</a></h3>
<div class="cell tag_remove-input docutils container">
</div>
<p>The final step of command line processing depends on whether we are using the shell as an interactive human interface, or using it more like a programming language.</p>
<section id="interactive-mode">
<h4><span class="section-number">4.7.8.1. </span>Interactive Mode<a class="headerlink" href="#interactive-mode" title="Permalink to this heading">#</a></h4>
<p>In the first case, which we have been focusing on in this chapter, the shell’s standard streams are connected to a terminal that we, as a human user, control.  As such, what the shell should do next depends on what we want to do. As we have seen, this “interaction” works like a conversation: the shell letting us know it is ready by printing a prompt string, and patiently waiting for us to give it the next command line to work on.</p>
</section>
<section id="non-interactive-mode-script-mode">
<h4><span class="section-number">4.7.8.2. </span>Non-Interactive Mode (Script Mode)<a class="headerlink" href="#non-interactive-mode-script-mode" title="Permalink to this heading">#</a></h4>
<p>Alternatively, we can use the shell as if it were a command itself - passing to it, as an argument, the path of a file from which it should read the command lines.  This will create a new shell process that does not read its command line from its standard input, but rather from the file. We call the file a script.</p>
<p>When started in this way, the shell will adopt a non-interactive behavior. It will not print a prompt and wait for us to enter the next command lines.  Instead, the shell will immediately read the next command line from the script file.  When the new non-interactive shell processes reaches the end of the file, it will exit.</p>
<p>For example:</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Using <code class="docutils literal notranslate"><span class="pre">cat</span></code> and redirection we put the three command lines in a file called my script. Now we can start a new bash that reads and runs these commands and then exits.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Shells, typically, also provide a built in command that allows the current shell to read commands from another file and not exit.  In other words, rather than starting a new shell the current shell will simply process a set of commands from the specified file and then go back to getting commands from where it was originally.</p>
<p>In bash the command to do this is <code class="docutils literal notranslate"><span class="pre">source</span></code>, and a shortcut for this is <code class="docutils literal notranslate"><span class="pre">.</span></code>.  For example</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>And using using the short cut it.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>In the <span class="xref myst">Shell Scripting</span> chapter we will look at how we make use of the shell syntax more like a programming language.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>There is a very big difference between starting a new shell to run a script file and having the current shell process source commands from a script file.  In the former case, we are running the commands in a brand new shell process that is independent from the current shell.  This means that variables it sets and other actions it takes do not affect the shell process that launched the script.  However when we source a script, it is as if we entered those commands directly in the current shell, so the commands will affect the variables and other aspects of the current shell.</p>
<p>In the example above, when we ran the file <code class="docutils literal notranslate"><span class="pre">myscript</span></code> as its own bash process the <code class="docutils literal notranslate"><span class="pre">today</span></code> variable was not added to the current shell’s variables.  However, when we sourced <code class="docutils literal notranslate"><span class="pre">myscript</span></code>, it did introduce and update a <code class="docutils literal notranslate"><span class="pre">today</span></code> variable in the current shell that we are interacting with.</p>
</div>
<p><a id="sec:shbang"></a></p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>You may be wondering why, in an earlier example, did we add the first line <code class="docutils literal notranslate"><span class="pre">#!/bin/bash</span></code> to our <code class="docutils literal notranslate"><span class="pre">cat</span></code> replacement <strong>shell script</strong>, and why we did not have to do that with the <code class="docutils literal notranslate"><span class="pre">myscript</span></code> example.</p>
<p>In the first case we were exploring how to get the current shell to treat the file as if it were an external command. Our goal was to have the shell get to step B of the <span class="xref myst">flow chart of command line processing</span>, and have the kernel successfully start it as a new process so that decision 5 would result in a No, and the shell would proceed to step 5 of command line processing.  To trigger this pathway we needed to make sure the kernel would - on its own - be able to identify the file as a script.</p>
<p>The kernel has an automatic behavior for recognizing files that should be treated as commands to be interpreted by another binary program, such as <code class="docutils literal notranslate"><span class="pre">bash</span></code> or <code class="docutils literal notranslate"><span class="pre">python</span></code>.   We will be discussing what exactly a <code class="docutils literal notranslate"><span class="pre">binary</span></code> program is later.  Regardless, if the file asked to be launched is marked as executable, but not a binary, the kernel will examine the beginning of the file.  If it finds the pattern <code class="docutils literal notranslate"><span class="pre">#!&lt;path&gt;</span></code> it will try starting the specified  <path> as a process, passing in the original file as the new process’s first argument.</p>
<p>In our <code class="docutils literal notranslate"><span class="pre">cat</span></code> example, the kernel examines the file to start a new process.  The file is not a binary, rather, it is just a file of ascii lines.   As such, it will examine it and find the  first line and realize that it must launch the specified <code class="docutils literal notranslate"><span class="pre">binary</span></code> and pass the original file as the first argument.  In this case, the kernel starts <code class="docutils literal notranslate"><span class="pre">/bin/bash</span></code>, passing <code class="docutils literal notranslate"><span class="pre">/home/jovyan/mybin/cat</span></code> as its first argument.  So in our case, it turns out to be the equivalent to: <code class="docutils literal notranslate"><span class="pre">/bin/bash</span> <span class="pre">/home/jovyan/mybin/cat</span></code>.   Conveniently, when the new <code class="docutils literal notranslate"><span class="pre">bash</span></code> process starts and reads the first line it will ignore it, as it starts with a <code class="docutils literal notranslate"><span class="pre">#</span></code> and will be treated as a comment.  This is why so many interpreted languages use <code class="docutils literal notranslate"><span class="pre">#</span></code> as their comment character.</p>
<p>In the second case of <code class="docutils literal notranslate"><span class="pre">myscript</span></code>, we manually started a new bash process and passed the <code class="docutils literal notranslate"><span class="pre">myscript</span></code> file as its argument, eg: <code class="docutils literal notranslate"><span class="pre">bash</span> <span class="pre">myscript</span></code> So we did not need the kernels help.  Rather, we started the new <code class="docutils literal notranslate"><span class="pre">bash</span></code> process and told it to read the file as a <strong>shell script</strong>.</p>
<p>Notice the shell command line execution steps do provide us a way to have <code class="docutils literal notranslate"><span class="pre">myscript</span></code> started as an external shell script command without adding the first line.    Examine the <span class="xref myst">flow chart of command line processing</span>, and look at step <code class="docutils literal notranslate"><span class="pre">D</span></code>.  If the kernel fails to be able to start a new process from the specified file, the behavior of step <code class="docutils literal notranslate"><span class="pre">D</span></code> is to start a new shell process passing the specified file as a script to it.   So the default behavior is that any non-binary file that is marked as executable will be treated as a <strong>shell script</strong>.  This default behavior lets us easily treat any file as a <strong>shell script</strong> simply by marking it as executable.</p>
</div>
</section>
</section>
</section>
<section id="four-forms-of-command-lines">
<h2><span class="section-number">4.8. </span>Four Forms of Command lines<a class="headerlink" href="#four-forms-of-command-lines" title="Permalink to this heading">#</a></h2>
<p>Now that we have looked at how a command line is processed, we can look at the four broader forms of command lines</p>
<ol class="arabic simple">
<li><p>Simple Commands,</p></li>
<li><p>Pipelines,</p></li>
<li><p>List of Commands,</p></li>
<li><p>Compound Commands.</p></li>
</ol>
<section id="simple-commands">
<h3><span class="section-number">4.8.1. </span>Simple Commands<a class="headerlink" href="#simple-commands" title="Permalink to this heading">#</a></h3>
<p>Simple commands have largely been our focus as we’ve discussed command line processing so far.  They are composed of a single command, builtin or external, along with optional arguments and redirections.  Of course remember that all the various expansions will be conducted prior to the execution of the command.</p>
<p>Now lets look at the three other forms of commands the shell provides support for, and see how they allow us to compose and group multiple commands together.</p>
</section>
<section id="pipelines">
<h3><span class="section-number">4.8.2. </span>Pipelines<a class="headerlink" href="#pipelines" title="Permalink to this heading">#</a></h3>
<p>When discussing <span class="xref myst">Parsing Redirections</span> we mentioned that the  kernel provides a special type of file called a “pipe”.   Pipes allow an output stream of one process to be connected to the input stream of another process.  Part of what makes a pipe special is that the kernel ensures that the two processes connected to a pipe stay coordinated when they write and read to and from a pipe.</p>
<p>The shell uses the kernel provided pipe files to support shell pipelines.    We will examine the details of how  the shell uses pipes to set up the standard output and input streams of processes in the next chapter, [Shell II: Files, Processes and Credentials].  Here, we will focus on the syntax the shell provides for creating and using pipelines.</p>
<section id="a-building-block-for-composing-commands">
<h4><span class="section-number">4.8.2.1. </span>A building block for composing commands<a class="headerlink" href="#a-building-block-for-composing-commands" title="Permalink to this heading">#</a></h4>
<p>As we read earlier, a core philosophy of the UNIX environment is that commands should be external programs that should focus on doing one task well.  For example, we saw that the <code class="docutils literal notranslate"><span class="pre">cat</span></code> command focuses simply on being able to copy bytes from a file, or its standard input stream, to its standard output stream.</p>
<p>There are a whole set of standard UNIX programs that are designed to process lines of ASCII they read from their standard input stream and produce ASCII output to their standard output stream.    The following are examples of a few that we will use to demonstrate how pipelines work.  These programs form the bread and butter of why UNIX is so popular among programmers and data scientists.</p>
<section id="counting-wc">
<h5><span class="section-number">4.8.2.1.1. </span>Counting (<code class="docutils literal notranslate"><span class="pre">wc</span></code>):<a class="headerlink" href="#counting-wc" title="Permalink to this heading">#</a></h5>
<p>The <code class="docutils literal notranslate"><span class="pre">wc</span></code> program, while very simple, can be very powerful.  <code class="docutils literal notranslate"><span class="pre">wc</span></code> program counts the number of lines, words, and characters it reads.  When it is done reading the input, it sends the counts to its standard output.</p>
<p>Here is an example of using it to count lines:</p>
<p>We start it with the <code class="docutils literal notranslate"><span class="pre">-l</span></code> argument to tell it we are only interested in  counting lines</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>It is now waiting to read lines of ASCII text from its standard input which of course is our terminal since we did not provide any redirections or file paths as arguments.  So let’s give it some.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Notice we don’t see any output yet, as we have not ended the standard input stream.  To do this, we need to press control-d.  But first, let’s send a few more lines and then press control-d to see what <code class="docutils literal notranslate"><span class="pre">wc</span></code> does.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Upon letting <code class="docutils literal notranslate"><span class="pre">wc</span></code> know that we are done by closing the stream, it prints the value 4 which is the count of the number of lines we entered.  Its a good idea to go ahead and play with <code class="docutils literal notranslate"><span class="pre">wc</span></code> a little.  The following is the man page for <code class="docutils literal notranslate"><span class="pre">wc</span></code>.</p>
<div class="cell tag_output_scroll tag_remove-input docutils container">
</div>
</section>
<section id="searching-grep">
<h5><span class="section-number">4.8.2.1.2. </span>Searching  (<code class="docutils literal notranslate"><span class="pre">grep</span></code>)<a class="headerlink" href="#searching-grep" title="Permalink to this heading">#</a></h5>
<p>A very important operation we often want to do is search for lines that contain something we are looking for.  UNIX has a long history of tools and mechanisms for searching ASCII line-oriented data.  As a matter of fact, an entire language developed for describing a pattern to search for.  This language is called <a class="reference external" href="https://en.wikipedia.org/wiki/Regular_expression">Regular Expressions</a> and a particular pattern in this language is referred to as a regular expression.
You will often see the shorthand “regex” to refer to a regular expression.  Over the years various variants of the regular expression syntax have arisen.</p>
<p>Many different UNIX tools understand some variant of the regular expression syntax.  In general, it can take some time to learn the nuances of the regular expression syntax.  Most of us start by using regular expressions in the context of some UNIX commands, and in time grow our knowledge.  Our goal here is not to focus on the regular expression syntax, but rather just introduce the UNIX program called <code class="docutils literal notranslate"><span class="pre">grep</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">grep</span></code> is a powerful tool that lets us search ASCII lines of text for a pattern written using a regular expression syntax.  The main argument to <code class="docutils literal notranslate"><span class="pre">grep</span></code> is a regex.   By default, <code class="docutils literal notranslate"><span class="pre">grep</span></code> will search each line it reads from the standard input stream and see if the line contains a match for the regex it was passed.  If a match is found, <code class="docutils literal notranslate"><span class="pre">grep</span></code> will print the line to it standard output.  In this way, <code class="docutils literal notranslate"><span class="pre">grep</span></code> can be used to filter out only lines that contain something you are looking for.</p>
<p>At this point we are only going to use very simple regexs, where the regex is simply a sequence of standard letters.  As such, if the line contains one or more occurrences of the sequence, including within a word, the line will be printed to standard output, and if not it will be skipped.</p>
<p>Lets see an example.  We start by starting grep with a regex of <code class="docutils literal notranslate"><span class="pre">Jill</span></code>, then we enter some lines of text, and press control-d to close the standard input stream.</p>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
</div>
<p>Lets type our text in again.  Notice as we enter the lines, we see grep print a second copy of the line if it contains our regex (<code class="docutils literal notranslate"><span class="pre">Jill</span></code>).</p>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
</div>
<p>Here is the man page for <code class="docutils literal notranslate"><span class="pre">grep</span></code>.  Note, like all man pages the details can be overwhelming at first.  The real point is to just skim it and then go back to it when you need to lookup a detail.</p>
<div class="cell tag_remove-input tag_output_scroll docutils container">
</div>
</section>
</section>
<section id="pipeline-examples">
<h4><span class="section-number">4.8.2.2. </span>Pipeline examples<a class="headerlink" href="#pipeline-examples" title="Permalink to this heading">#</a></h4>
<p>Ok, now that we have a few commands at our disposal, lets compose them with pipelines.  So the idea is rather than our command line containing a single simple command, we will chain simple commands together into a pipeline.  The shell will handle all the details for having the kernel create the pipe files, and creating one process for each simple command and hooking up their standard streams.</p>
<p>The syntax we use is the the vertical bar symbol <code class="docutils literal notranslate"><span class="pre">|</span></code>.  We simply place it between our two simple commands.  Again, remember that all the stages of command line processing will occur. The only difference is that the shell will create multiple processes as needed.  Once started, the processes of the pipeline will continue as a unit.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You might have noticed that when we create a pipeline using the <code class="docutils literal notranslate"><span class="pre">|</span></code> symbol to start and connect two commands as processes, we are only connecting the standard output stream of the left command to the standard input of the right command.</p>
<p>We might, however, like to send both the standard output and standard error stream from the command on the left to the command on the right.    There are actually several ways to do this, but as a shortcut bash lets us use <code class="docutils literal notranslate"><span class="pre">|&amp;</span></code>. This will send both the standard output and standard error streams of the left command to the standard input of the right command.</p>
</div>
<div class="note admonition">
<p class="admonition-title">Details of pipelines as a unit</p>
<p>The following are some of the details of how the processes of a pipeline behave as a single unit. The shell will group all processes of the pipeline into what is called a single <code class="docutils literal notranslate"><span class="pre">job</span></code>. It waits for all processes of the pipeline to exit.  This means that when we start a pipeline, as a “normal”, synchronous command the shell will not get the next command line until all processes of the current job complete.</p>
<p>Similarly, if we start a pipeline as a asynchronous command all the processes will be group together and can be managed as one job.</p>
<p>Like a simple commands the shell will set a exit status code for a pipeline.  By default this will be the exit status of the right most command of the pipeline.  In bash this behavior can be changed if you want (see the <code class="docutils literal notranslate"><span class="pre">pipefail</span></code> option to the <a class="reference external" href="https://www.gnu.org/software/bash/manual/html_node/The-Set-Builtin.html">set</a> built in command.</p>
</div>
<section id="a-two-command-pipeline">
<h5><span class="section-number">4.8.2.2.1. </span>A Two command pipeline<a class="headerlink" href="#a-two-command-pipeline" title="Permalink to this heading">#</a></h5>
<p>Lets combine the two separate example from above.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Now, lets again send our text into the standard input, and then press control-d.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Ok so what happened?  The shell created a pipeline composed of two processes.</p>
<ol class="arabic simple">
<li><p>The first being <code class="docutils literal notranslate"><span class="pre">grep</span></code>, with its standard input coming from the default file.  Recall that this means it is the terminal that the bash is using.  Because of this, the lines we type in next will be read as the input for <code class="docutils literal notranslate"><span class="pre">grep</span></code>.  The pipe symbol <code class="docutils literal notranslate"><span class="pre">|</span></code> acts like a redirection that tells the shell to create a pipe file and have the standard output of the command on the left be directed to the standard input of the process on the right.</p></li>
<li><p>The second process that the shell starts is <code class="docutils literal notranslate"><span class="pre">wc</span></code>.  Given that it is on the right of the pipe symbol its standard input will be redirected to come from the the pipe file that shell creates.  Which in turn will cause the <code class="docutils literal notranslate"><span class="pre">wc</span></code> to read its input from the output of <code class="docutils literal notranslate"><span class="pre">grep</span></code>. Its output, on the other hand, will go to the same place that the shell’s output is going … the terminal</p></li>
</ol>
<p>In this way, the pipeline composes the two programs so that together they will print the number of lines that contain the word <code class="docutils literal notranslate"><span class="pre">Jill</span></code>!</p>
</section>
<section id="a-three-command-pipeline">
<h5><span class="section-number">4.8.2.2.2. </span>A three command pipeline<a class="headerlink" href="#a-three-command-pipeline" title="Permalink to this heading">#</a></h5>
<p>Let’s look at one more example.  Using <code class="docutils literal notranslate"><span class="pre">ls</span></code>, we can list the contents of a directory such as <code class="docutils literal notranslate"><span class="pre">/bin</span></code> which, as we have seen, has a lot of executable files in it.  Let’s use pipes to work with the list.</p>
<p>First, let’s use a two command pipe to count the number of files in `/bin’</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Now, let’s see how many of the files have the word <code class="docutils literal notranslate"><span class="pre">file</span></code> as part of their name.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Now, lets use a three command pipe to count the number.</p>
<div class="cell tag_remove-input docutils container">
</div>
</section>
<section id="pipelines-vs-simple-commands">
<h5><span class="section-number">4.8.2.2.3. </span>Pipelines vs simple commands<a class="headerlink" href="#pipelines-vs-simple-commands" title="Permalink to this heading">#</a></h5>
<p>Pipelines are a generalization of a simple command.  Pipelines group the execution of several commands into one unit.  Now that we know about pipes, they will become our building block for more involved forms of command lines.</p>
<div class="note admonition">
<p class="admonition-title">Commentary</p>
<p>Hopefully this gives you a sense for why so many computer scientists love UNIX.  Notice all the little ideas that fit together so nicely.</p>
<ul class="simple">
<li><p>A simple model in which a program is designed to read its input from its standard input stream and produce its output to its standard output stream</p></li>
<li><p>A simple model that allows any external program to extend the commands of the OS</p></li>
<li><p>A generic special file type that allows programs to coordinate the writing and reading of data</p></li>
</ul>
<p>The shell unifies these ideas into a convenient interface.  Now that you have  learned  the syntax for pipes, every new program you discover extends the combinations you can create!  Have fun exploring and being creative with pipelines!</p>
</div>
<p><a id='sec:cmdlists'></a></p>
</section>
</section>
</section>
<section id="list-of-commands">
<h3><span class="section-number">4.8.3. </span>List of Commands<a class="headerlink" href="#list-of-commands" title="Permalink to this heading">#</a></h3>
<p>There are four <span class="xref myst">shell control operators</span> <code class="docutils literal notranslate"><span class="pre">;</span></code>, <code class="docutils literal notranslate"><span class="pre">&amp;</span></code>, <code class="docutils literal notranslate"><span class="pre">&amp;&amp;</span></code>, and <code class="docutils literal notranslate"><span class="pre">||</span></code> that let us create a command line composed of a list of commands.  The list can be terminated by a newline or a final <code class="docutils literal notranslate"><span class="pre">;</span></code> or <code class="docutils literal notranslate"><span class="pre">&amp;</span></code>.</p>
<section id="sequential-list-of-commands">
<h4><span class="section-number">4.8.3.1. </span>Sequential list of commands<a class="headerlink" href="#sequential-list-of-commands" title="Permalink to this heading">#</a></h4>
<p>The sequential list operator, semicolon (<code class="docutils literal notranslate"><span class="pre">;</span></code>), simply lets us list one command after another on the same command line.  Each command will execute one after the other.</p>
<p>For example, lets use <code class="docutils literal notranslate"><span class="pre">;</span></code> to put three commands together on the same command line:</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Our three commands were:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">hello</span></code> : send hello to standard output</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ls</span> <span class="pre">~</span> <span class="pre">|</span> <span class="pre">wc</span> <span class="pre">-l</span></code> : a pipeline composed of:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ls</span> <span class="pre">~</span></code> : list the contents of the home directory to standard output which is redirected to the second command</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wc</span> <span class="pre">-l</span></code> : count the number of lines read from standard input and send the count to standard output</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">cat</span> <span class="pre">/etc/passwd</span> <span class="pre">:</span> <span class="pre">grep</span> <span class="pre">jovyan</span></code> : a pipeline composed of:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cat</span> <span class="pre">/etc/passwd</span></code> : copy the contents of the file <code class="docutils literal notranslate"><span class="pre">/etc/passwd</span></code> to standard output</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">grep</span> <span class="pre">jovyan</span></code> : use grep to search lines read from standard input for the sequence of characters <code class="docutils literal notranslate"><span class="pre">jovyan</span></code>, and print any lines that match to standard output.</p></li>
</ul>
</li>
</ol>
</section>
<section id="background-asynchronous">
<h4><span class="section-number">4.8.3.2. </span>Background / Asynchronous<a class="headerlink" href="#background-asynchronous" title="Permalink to this heading">#</a></h4>
<p>As we have seen when, executing commands they can be started asynchronously.  In this case, the shell starts the command but does not wait for it to complete before trying to read the next command.  Such commands are called background commands, and the <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> operator is the background operator.</p>
<p>Like the <code class="docutils literal notranslate"><span class="pre">;</span></code>, we can use the <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> operator to join multiple commands on the same command line.  The command to the left of the <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> will be started asynchronously. The one on the right will be started immediately after the left command is started.</p>
<p>We will discuss more details regarding background commands in the next chapter. For the moment, let’s look at a couple of simple examples so that we can see the how the syntax looks.<br />
In these examples we will use the <code class="docutils literal notranslate"><span class="pre">sleep</span></code> command, which is an external command that simply runs as a process and then exits after the specified amount of time.  By default, the time is in seconds. Eg.  <code class="docutils literal notranslate"><span class="pre">sleep</span> <span class="pre">5</span></code> will run for 5 seconds.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>We will also use the <code class="docutils literal notranslate"><span class="pre">date</span></code> command that prints the current date and time. Eg.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>As always, you can use the <code class="docutils literal notranslate"><span class="pre">man</span></code> or <code class="docutils literal notranslate"><span class="pre">info</span></code> command to learn more about these programs (<code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">sleep</span></code>, <code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">date</span></code>, <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">sleep</span></code>, and <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">date</span></code>).</p>
<p>Let’s first use <code class="docutils literal notranslate"><span class="pre">;</span></code> to run these commands as a sequence.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Notice the second execution of <code class="docutils literal notranslate"><span class="pre">date</span></code> reflects the fact that it ran after the <code class="docutils literal notranslate"><span class="pre">sleep</span> <span class="pre">10</span></code> command.</p>
<p>Now let’s use the <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> between the <code class="docutils literal notranslate"><span class="pre">sleep</span></code> and the second <code class="docutils literal notranslate"><span class="pre">date</span></code>.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Notice, this time we see an extra line, and we see that the second execution of <code class="docutils literal notranslate"><span class="pre">date</span></code> happened immediately.  The line in the middle is output from the shell letting us know that it started a background job, and providing some information about it.  Again, we will discuss these details in the next chapter.</p>
</section>
<section id="and-list">
<h4><span class="section-number">4.8.3.3. </span>AND list<a class="headerlink" href="#and-list" title="Permalink to this heading">#</a></h4>
<p>Another way that we can combine commands is to use the AND operator <code class="docutils literal notranslate"><span class="pre">&amp;&amp;</span></code> between two commands.  Like the <code class="docutils literal notranslate"><span class="pre">;</span></code> the commands will be executed sequentially, one after the other.  However, the second command will only execute if the exit status of the first is 0.  Remember, by UNIX convention the exit status of a program should be 0 to indicate that everything went ok and the command was successful.</p>
<p>So in other words, <code class="docutils literal notranslate"><span class="pre">&amp;&amp;</span></code> operator is a like an “if” statement.  If the first command is successful, then the second command will be executed.  However if the first command exits with a non-zero exit status, then the second command will not run.</p>
<p>Let’s look at an example using <code class="docutils literal notranslate"><span class="pre">grep</span></code>.  If <code class="docutils literal notranslate"><span class="pre">grep</span></code> does not find any matches it returns a non-zero exit status, however, if it finds at least one match it returns a zero exit status.</p>
<p>With this in mind, we will use <code class="docutils literal notranslate"><span class="pre">grep</span></code> to search the file of users <code class="docutils literal notranslate"><span class="pre">/etc/passwd</span></code> for lines that match a particular sequence.  In the first case, we will look for <code class="docutils literal notranslate"><span class="pre">jovyan</span></code> (our user name), and in the second case we will use <code class="docutils literal notranslate"><span class="pre">foo</span></code> which does not match any lines in <code class="docutils literal notranslate"><span class="pre">/etc/passwd</span></code>.</p>
<p>Let’s first test out how the two uses of <code class="docutils literal notranslate"><span class="pre">grep</span></code> behave.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Remember that the shell records the exit status of the last command in a special variable <code class="docutils literal notranslate"><span class="pre">?</span></code>. So the above command line executed the <code class="docutils literal notranslate"><span class="pre">grep</span> <span class="pre">jovyan</span> <span class="pre">/etc/passwd</span></code>, and then <code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">$?</span></code>.  The <code class="docutils literal notranslate"><span class="pre">;</span></code> was used to combine these two commands in sequential list.  The first line of output we see is from <code class="docutils literal notranslate"><span class="pre">grep</span></code> and is the single line it found that matched out regex. The second
line is the output from echo <code class="docutils literal notranslate"><span class="pre">$?</span></code>.  During expansion, the <code class="docutils literal notranslate"><span class="pre">$?</span></code> was expanded to the value of the the exit status of the last command, which was <code class="docutils literal notranslate"><span class="pre">grep</span> <span class="pre">jovyan</span> <span class="pre">/etc/passwd</span></code>.</p>
<p>Let’s retry this but with a regex of <code class="docutils literal notranslate"><span class="pre">foo</span></code> that we know does not match any lines of <code class="docutils literal notranslate"><span class="pre">/etc/passwd</span></code>.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>This time, as expected, we don’t see any output from the <code class="docutils literal notranslate"><span class="pre">grep</span></code> as no lines matched our regex.  The output from echo is now <code class="docutils literal notranslate"><span class="pre">1</span></code> which is the exit status of <code class="docutils literal notranslate"><span class="pre">grep</span></code> when no matches are found.</p>
<p>Now that we have seen how <code class="docutils literal notranslate"><span class="pre">grep</span></code> behaves, with respect to its exit statuses, lets use the <code class="docutils literal notranslate"><span class="pre">&amp;&amp;</span></code> operator.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>In the above we use the  <code class="docutils literal notranslate"><span class="pre">&amp;&amp;</span></code>, AND list operator, to create a list of two commands the first <code class="docutils literal notranslate"><span class="pre">grep</span> <span class="pre">jovyan</span> <span class="pre">/etc/passwd</span></code> and the second <code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">'found</span> <span class="pre">it'</span></code>.  Given that the regex, <code class="docutils literal notranslate"><span class="pre">jovyan</span></code> is matches a line in the file we see the matching line printed.  We also see the string <code class="docutils literal notranslate"><span class="pre">found</span> <span class="pre">it</span></code> printed.</p>
<p>As expected, given that the exit status of the <code class="docutils literal notranslate"><span class="pre">grep</span></code> command  is zero, indicating success, the echo was then executed.</p>
<p>Now, let’s try it with the non-matching regex.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>This time we see no output from the command line.  Given that no lines matched, <code class="docutils literal notranslate"><span class="pre">grep</span></code> did not print anything.  Additionally, its exit status would have been non-zero.  Given the non-zero exit status, <code class="docutils literal notranslate"><span class="pre">bash</span></code> did not execute the second command, so the echo was simply skipped.</p>
</section>
<section id="or-list">
<h4><span class="section-number">4.8.3.4. </span>OR list<a class="headerlink" href="#or-list" title="Permalink to this heading">#</a></h4>
<p>Similar to the AND list, <code class="docutils literal notranslate"><span class="pre">bash</span></code> supports an OR list.  The operator is <code class="docutils literal notranslate"><span class="pre">||</span></code>.  In this case, the second command is executed only if the first returns with a non-zero exit status indicating failure.</p>
<p>Let’s look at the OR list operator with a simple example similar to the one we used to explore the AND list operator.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Unsurprisingly, the above OR list composed of the two commands: 1) <code class="docutils literal notranslate"><span class="pre">grep</span> <span class="pre">jovyan</span> <span class="pre">/etc/passwd</span></code> and 2) <code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">'not</span> <span class="pre">found</span></code> produces only one line of output.  The <code class="docutils literal notranslate"><span class="pre">grep</span></code> succeeds and prints the matching line it found.  However, the shell skips running the <code class="docutils literal notranslate"><span class="pre">echo</span></code> command as the exit status of the <code class="docutils literal notranslate"><span class="pre">grep</span></code> was zero indicating success.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>As expected, when we run the above command line in which the first command, <code class="docutils literal notranslate"><span class="pre">grep</span> <span class="pre">foo</span> <span class="pre">/etc/passwd</span></code>,  “fails” the second command <code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">'not</span> <span class="pre">found'</span></code> is executed.</p>
</section>
</section>
<section id="compound-commands">
<h3><span class="section-number">4.8.4. </span>Compound Commands<a class="headerlink" href="#compound-commands" title="Permalink to this heading">#</a></h3>
<p>The next form of commands, compound commands, are where we really see the shell take on the power of a programming language.  Compound commands allow us to group commands together into:</p>
<ol class="arabic simple">
<li><p>Loops</p></li>
<li><p>Conditionals</p></li>
<li><p>Generic Groups</p></li>
</ol>
<p>All the commandsof a group have their output and input redirected as a unit and produce a single exit status.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Perhaps the coolest aspect of the shell, as a programming language, is that any external command becomes part of the language.    The shell itself only provides a few special “reserved” words that allow us to create things like “loops” and “if” structures. Since all commands return an exit status, in addition to using commands to form the body of a conditional expression, they can also be used as the condition itself. This includes any new programs we add to the system! So by adding new programs to the system we are effectively expanding the syntax of a powerful programming language.</p>
</div>
<section id="loops">
<h4><span class="section-number">4.8.4.1. </span>Loops<a class="headerlink" href="#loops" title="Permalink to this heading">#</a></h4>
<p>Like other programming languages, you might be familiar with, the shell supports: <code class="docutils literal notranslate"><span class="pre">until</span></code>, <code class="docutils literal notranslate"><span class="pre">while</span></code> and <code class="docutils literal notranslate"><span class="pre">for</span></code> loops.  At this point we are not going to look at the details, rather we will just look a a few examples.  To learn more use the <code class="docutils literal notranslate"><span class="pre">help</span></code> command (eg. <code class="docutils literal notranslate"><span class="pre">help</span> <span class="pre">until</span></code>, <code class="docutils literal notranslate"><span class="pre">help</span> <span class="pre">while</span></code>, and <code class="docutils literal notranslate"><span class="pre">help</span> <span class="pre">for</span></code>) and look at <a class="reference external" href="https://www.gnu.org/software/bash/manual/html_node/Looping-Constructs.html">Looping Constructs</a> section of the manual.</p>
<p>Here is an example of a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop.  Here, the shell variable, fruit in this case, will iterate over the list of words after the <code class="docutils literal notranslate"><span class="pre">in</span></code> keyword.  The body of the loop is made up of the commands between the keywords <code class="docutils literal notranslate"><span class="pre">do</span></code> and <code class="docutils literal notranslate"><span class="pre">done</span></code>.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Rather than using <code class="docutils literal notranslate"><span class="pre">;</span></code> to separate the commands of the body we can use newlines.  This allows us to make our loop more readable.  This is critical when one writes scripts.  When we use  newlines in an interactive shell to break up the commands of a compound command, like a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop, the shell prints a different prompt to let us know that what we are typing is really part of the same command.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Here is another type of <code class="docutils literal notranslate"><span class="pre">for</span></code> loop that <code class="docutils literal notranslate"><span class="pre">bash</span></code> supports. This form of a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop combines the <code class="docutils literal notranslate"><span class="pre">bash</span></code> support for arithmetic with looping</p>
<div class="cell tag_remove-input docutils container">
</div>
</section>
<section id="conditionals">
<h4><span class="section-number">4.8.4.2. </span>Conditionals<a class="headerlink" href="#conditionals" title="Permalink to this heading">#</a></h4>
<p>We have already seen support for conditional execution in the form of AND and OR list operators.  There is, however, richer support for several types of conditionals.  Again we are not going to look at the details now, but rather refer you to the documentation:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">help</span> <span class="pre">if</span></code>  : support for “if” “then” “else” structures</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">help</span> <span class="pre">case</span></code> : support for “switch” structures</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">help</span> <span class="pre">select</span></code> : support for interactive menus</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">help</span> <span class="pre">[[</span></code> : very powerful support for writing conditional expressions that return an exit status of either zero or non-zero.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">help</span> <span class="pre">test</span></code> : documents the syntax for various conditional expressions</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">help</span> <span class="pre">let</span></code> : the use of shell arithmetic expression as a conditional.</p></li>
</ul>
<p>The following is the section in the manual that discusses <a class="reference external" href="https://www.gnu.org/software/bash/manual/html_node/Conditional-Constructs.html">Conditional Constructs</a></p>
<p>Here are a couple of examples of <code class="docutils literal notranslate"><span class="pre">if</span></code> command lines to get you started.</p>
<ol class="arabic simple">
<li><p>Using an <code class="docutils literal notranslate"><span class="pre">if</span></code> statement, we can explicitly say what commands should run if the expression command returns a success or failure exit status.</p></li>
</ol>
<div class="cell tag_remove-input docutils container">
</div>
<ol class="arabic simple" start="2">
<li><p>We can use the <code class="docutils literal notranslate"><span class="pre">!</span></code> keyword to logically negate the result</p></li>
</ol>
<div class="cell tag_remove-input docutils container">
</div>
<ol class="arabic simple" start="3">
<li><p>The bash <code class="docutils literal notranslate"><span class="pre">[[</span></code> - execute conditional expression - support has the ability to express lots of different conditional statements.   The below condition tests to see if a file called <code class="docutils literal notranslate"><span class="pre">thefile</span></code> exists.</p></li>
</ol>
<div class="cell tag_remove-input docutils container">
</div>
<ol class="arabic simple" start="4">
<li><p>We can also test if strings match each other</p></li>
</ol>
<div class="cell tag_remove-input docutils container">
</div>
<p><a id="sec:groups"></a></p>
</section>
<section id="groups">
<h4><span class="section-number">4.8.4.3. </span>Groups<a class="headerlink" href="#groups" title="Permalink to this heading">#</a></h4>
<p>As we have seen, the shell provides us with a way of creating a list of commands to execute.  Each command, however, is really an independent command.  If you want to redirect the input and output of all of them, you must provide redirections for each.</p>
<p>The shell provides two ways to group a list of commands so that they can be worked on as a single unit.</p>
<section id="grouping">
<h5><span class="section-number">4.8.4.3.1. </span>() grouping<a class="headerlink" href="#grouping" title="Permalink to this heading">#</a></h5>
<p>The first is to enclose the list in a set of parenthesis <code class="docutils literal notranslate"><span class="pre">()</span></code>.  When you do this, you are telling the shell to create a new sub-shell (<code class="docutils literal notranslate"><span class="pre">bash</span></code> process), and run all the commands within it.  This means that you can provide a single set of redirections for the entire unit.</p>
<p>For example, to run the <code class="docutils literal notranslate"><span class="pre">date</span></code> command, followed by the <code class="docutils literal notranslate"><span class="pre">ls</span></code> command, followed by <code class="docutils literal notranslate"><span class="pre">echo</span></code>, with their output redirected to a file we can use:</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>In the above example, the list of commands is run in a new bash process and the output of all the commands are redirected to the the file <code class="docutils literal notranslate"><span class="pre">myinfo</span></code></p>
</section>
<section id="id1">
<h5><span class="section-number">4.8.4.3.2. </span>{} grouping<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h5>
<p>The other supported way of treating a list of commands as a group is the use of braces to enclose the list.  The syntax is a little tricky.  You MUST use spaces between the braces and the list of commands, and the last command must be terminated with a <code class="docutils literal notranslate"><span class="pre">;</span></code></p>
<p>Eg.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>There is a core difference between the use of parenthesis <code class="docutils literal notranslate"><span class="pre">()</span></code> and braces <code class="docutils literal notranslate"><span class="pre">{}</span></code>.  Unlike a group created with <code class="docutils literal notranslate"><span class="pre">()</span></code>, a group created with <code class="docutils literal notranslate"><span class="pre">{}</span></code> does not start a new sub-shell.  Rather, the commands are executed within the current shell process.</p>
<p>At this point, the significance of this may not be clear.  When we look at the <span class="xref myst">Command Execution Environment</span>, we will gain a better understanding.</p>
</section>
</section>
</section>
</section>
<section id="user-defined-shell-functions">
<h2><span class="section-number">4.9. </span>User defined shell Functions<a class="headerlink" href="#user-defined-shell-functions" title="Permalink to this heading">#</a></h2>
<p>Another programming-like feature of the shell is the ability to create “functions”.  Functions allow us to group a set of commands together associated with a function name.  After defining the function, we can have the shell execute the commands of the function by using the name of the function as a command.</p>
<p>In the <span class="xref myst">Command line processing steps</span> decision 2 and step C check to see if a command matches the name of a defined function, and if so the shell will go on to execute the commands of the function.</p>
<p>Functions also support the ability to take in arguments.  Within the function, the arguments can be accessed through special positional parameters: <code class="docutils literal notranslate"><span class="pre">$1,</span> <span class="pre">$2,</span> <span class="pre">...</span></code> where each is assigned the value of the corresponding argument.  <code class="docutils literal notranslate"><span class="pre">$0</span></code> is the name of the function itself.</p>
<p>At this point we are not going to get into the details, but again refer you to the documentation:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">help</span> <span class="pre">function</span></code></p></li>
<li><p><a class="reference external" href="https://www.gnu.org/software/bash/manual/html_node/Shell-Functions.html">Shell Functions</a></p></li>
</ul>
<p>Here are two small examples:</p>
<ol class="arabic simple">
<li><p>Let’s define a function <code class="docutils literal notranslate"><span class="pre">h</span></code> that displays the current date and the contents of our home directory.</p></li>
</ol>
<div class="cell tag_remove-input docutils container">
</div>
<ol class="arabic simple" start="2">
<li><p>Here is a simple function that adds two numbers</p></li>
</ol>
<div class="cell tag_remove-input docutils container">
</div>
</section>
<section id="aliases">
<h2><span class="section-number">4.10. </span>Aliases<a class="headerlink" href="#aliases" title="Permalink to this heading">#</a></h2>
<p>In addition to functions, the shell provides a lightweight mechanism to define shortcuts for a command.  These are called aliases.  The builtin command <code class="docutils literal notranslate"><span class="pre">alias</span></code> lets you see what the current aliases are, and define new ones.</p>
<p>Aliases are a convenient way to customize your interactive experience.  You can use aliases to provide a short name for a longer command or provide default arguments.  As a matter of fact, often times the system will be set up to have a set of default aliases to make your life easier.</p>
<p>Lets use the <code class="docutils literal notranslate"><span class="pre">alias</span></code> command to see what, if any, aliases have been set up for us.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>What we find is that several aliases exist.  As a matter of fact <code class="docutils literal notranslate"><span class="pre">ls</span></code> is an alias to <code class="docutils literal notranslate"><span class="pre">ls</span> <span class="pre">--color=auto</span></code>.  If we read the man page we will find that the <code class="docutils literal notranslate"><span class="pre">--color=auto</span></code> option lets the <code class="docutils literal notranslate"><span class="pre">ls</span></code> program send color information to the terminal so that paths of different types will get colored differently.  We can see the difference by issuing <code class="docutils literal notranslate"><span class="pre">ls</span></code> as a command and <code class="docutils literal notranslate"><span class="pre">/bin/ls</span></code>.  The former will result in the alias and the later will forcibly run the <code class="docutils literal notranslate"><span class="pre">ls</span></code> program without any arguments.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>See <code class="docutils literal notranslate"><span class="pre">help</span> <span class="pre">alias</span></code> for more details.</p>
<p><a id="sec:env"></a></p>
</section>
<section id="command-execution-environment">
<h2><span class="section-number">4.11. </span>Command Execution Environment<a class="headerlink" href="#command-execution-environment" title="Permalink to this heading">#</a></h2>
<p>The shell maintains a collection of information that influences how command lines are processed.  This information can change over the period of the shell’s lifetime (from the moment the shell is started to the point at which the shell process exits).    We think of this information as the Execution Environment that command lines are executed within.</p>
<p>The set of information is quite big.  We will focus on a sub-set of this information that will not only help us be productive, but also help us understand the relationships between the shell, kernel and the processes that get started.</p>
<p>Specifically, we will focus on:</p>
<ol class="arabic simple">
<li><p>The current working directory</p></li>
<li><p>Open file descriptors</p></li>
<li><p>Exported environment variables</p></li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The following is a more complete list of the information that makes up the <code class="docutils literal notranslate"><span class="pre">bash</span></code> command execution environment.  You can explore what they are in the bash documentation.</p>
<ol class="arabic simple">
<li><p><strong>The set of currently open file descriptors</strong></p></li>
<li><p><strong>The current working directory</strong></p></li>
<li><p>Traps (set using the <code class="docutils literal notranslate"><span class="pre">trap</span></code> builtin command)</p></li>
<li><p><strong>Shell variables (or more precisely all Shell Parameters)</strong></p></li>
<li><p>User defined functions</p></li>
<li><p>Various options settings that affect the how the shell behaves (these can be changed with the builtin commands <code class="docutils literal notranslate"><span class="pre">set</span></code> and <code class="docutils literal notranslate"><span class="pre">shopt</span></code>)</p></li>
<li><p>Aliases (see the <code class="docutils literal notranslate"><span class="pre">alias</span></code> built in)</p></li>
<li><p>Process ids of commands started in the background, the process id of the process the shell itself and the process id of the process that started the shell (its parent)</p></li>
</ol>
</div>
<section id="process-inherited-portions">
<h3><span class="section-number">4.11.1. </span>Process inherited Portions<a class="headerlink" href="#process-inherited-portions" title="Permalink to this heading">#</a></h3>
<p>When the UNIX kernel creates a new process several facts are “inherited” from the parent process.  What this means is that the  new processes get a copy of the values that the parent process had at the time it was created.</p>
<p>Since processes are independent once a new child process has been created its copies of the information inherited from its parent are separate.  What this means is any changes that the parent or child makes to its copy does not affect each other.</p>
<p>In addition to the inherited portions of information that a new process is started with, there is information that is explicitly passed to the kernel by the parent.</p>
<p>When the shell creates new processes for us, the working directory and open file descriptors of the launching shell are inherited by the new process.  The shell also explicitly passes the command line arguments and a copy of the currently exported shell variables to the kernel.  When the kernel creates the new process, it ensures that the new process has a copy of this information within the process.</p>
</section>
<section id="working-directory">
<h3><span class="section-number">4.11.2. </span>Working directory<a class="headerlink" href="#working-directory" title="Permalink to this heading">#</a></h3>
<p>When discussing <span class="xref myst">absolute and relative paths</span> we introduced the idea that the kernel maintains a path for every process called the current working directory.  When a process asks the kernel to locate a path that is not absolute - it does not begin at the root of the file tree - the kernel uses the current working directory as a prefix.</p>
<p>From this perspective, the current working directory is a pointer to a location in the file tree that the kernel maintains for every process. The form of this pointer is simply an absolute path of a directory. The initial value of this path is inherited by a new process from its parent process.</p>
<p>Two core built in commands of <code class="docutils literal notranslate"><span class="pre">bash</span></code> are <code class="docutils literal notranslate"><span class="pre">pwd</span></code> and <code class="docutils literal notranslate"><span class="pre">cd</span></code>. The  <code class="docutils literal notranslate"><span class="pre">pwd</span></code> command prints the name of current working directory of the <code class="docutils literal notranslate"><span class="pre">bash</span></code> process.  The <code class="docutils literal notranslate"><span class="pre">cd</span></code> command changes the current working directory of the <code class="docutils literal notranslate"><span class="pre">bash</span></code> process.  Here are few examples of their use:</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>When <code class="docutils literal notranslate"><span class="pre">bash</span></code> launches a new process to run a command, the new process inherits the value of its current working directory from the <code class="docutils literal notranslate"><span class="pre">bash</span></code> process.  For example, when we run <code class="docutils literal notranslate"><span class="pre">ls</span></code>, <code class="docutils literal notranslate"><span class="pre">bash</span></code> will start a new process to execute the <code class="docutils literal notranslate"><span class="pre">ls</span></code> binary.  By default, if no arguments are passed to <code class="docutils literal notranslate"><span class="pre">ls</span></code> then <code class="docutils literal notranslate"><span class="pre">ls</span></code> will list the contents of its working directory.</p>
<p>With this in mind, let’s look at a couple of examples.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>Above we see that running <code class="docutils literal notranslate"><span class="pre">ls</span></code> on its own is the same as listing the contents of the current working directory of the <code class="docutils literal notranslate"><span class="pre">bash</span></code> process.</p>
<p>Here is another example.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>In the above, we see that the current working directory of <code class="docutils literal notranslate"><span class="pre">ls</span></code> follows the working directory of the launching bash.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When discussing the <span class="xref myst">grouping of commands</span> we learned that there were two forms of groups: 1) a list of commands enclosed in parenthesis <code class="docutils literal notranslate"><span class="pre">()</span></code> and 2) a list of commands enclosed in braces `{}.  We said that the former ran the list of commands as a new process, a sub-shell. Whereas the latter ran the commands within the current shell process.  Now that we know a little more about execution environments, we can explore the different implications of the two.</p>
<p>Given that the working directory is specific to a process, changing the working directory path in one process does not affect another. So if we run commands in a sub-shell, which is to start a new bash process and run commands within it, then changing the working directory in these commands will have no effect on the parent.</p>
<p>For example, compare what happens between running <code class="docutils literal notranslate"><span class="pre">cd</span></code> within a sub-shell group versus a non-sub-shell group.</p>
<ol class="arabic simple">
<li><p>First in a sub-shell</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">pwd</span>
/home/jovyan
$<span class="w"> </span><span class="o">(</span><span class="nb">cd</span><span class="w"> </span>/tmp<span class="p">;</span><span class="w"> </span>ls<span class="o">)</span>
$<span class="w"> </span><span class="nb">pwd</span>
/home/jovyan
$<span class="w"> </span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Second not in a sub-shell</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">pwd</span>
/home/jovyan
$<span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>/tmp<span class="p">;</span><span class="w"> </span>ls<span class="p">;</span><span class="w"> </span><span class="o">}</span>
$<span class="w"> </span><span class="nb">pwd</span>
/tmp
$
</pre></div>
</div>
<p>Notice how, in the second case, the current working directory of the <code class="docutils literal notranslate"><span class="pre">bash</span></code> we are interacting with is changed, and it is not in the first case.  In the first case, the <code class="docutils literal notranslate"><span class="pre">cd</span></code> was executed in a new child process and, as such, the effect of the <code class="docutils literal notranslate"><span class="pre">cd</span></code> was only on the  current working directory of the child.</p>
</div>
</section>
<section id="exported-shell-variables">
<h3><span class="section-number">4.11.3. </span>Exported Shell Variables<a class="headerlink" href="#exported-shell-variables" title="Permalink to this heading">#</a></h3>
<p>As we saw, the shell maintains a set of variables.  These variables are a set of names and values.   We saw that during expansion processing we could ask the shell to replace the name of a variable (prefixed by <code class="docutils literal notranslate"><span class="pre">$</span></code>) with the value of that variable.  While the shell provides several variables with special meaning, we can easily introduce our own variables through various syntax.</p>
<p>Eg.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>When a new process is started on UNIX, the kernel allows the parent to specify a set of “name=value” strings that will be copied into the new process. A particular name value pair is called an environment variable.</p>
<p>When the shell launches a new child process, it passes a subset of the the shell’s variables to the kernel to seed the child process’s environment variables.</p>
<p>In <code class="docutils literal notranslate"><span class="pre">bash</span></code> we can specify variables that are to be included in the set to be passed as environment variables to the new process.  There are two ways to do this:</p>
<ol class="arabic simple">
<li><p>We can mark a shell variable as “exported”. To do this, we can use the shell builtin command <code class="docutils literal notranslate"><span class="pre">export</span></code> or <code class="docutils literal notranslate"><span class="pre">set</span></code> (see <code class="docutils literal notranslate"><span class="pre">help</span> <span class="pre">export</span></code> and <code class="docutils literal notranslate"><span class="pre">help</span> <span class="pre">set</span></code>)</p></li>
<li><p>The other way is to prefix the command name with a set of “name=value” pairs.  In this case, they will not be added to the shell’s current variables but only passed as extra environment variables to the new child process.</p></li>
</ol>
<p>Let’s look at a few examples.  First let’s use the built in <code class="docutils literal notranslate"><span class="pre">export</span></code> command to see the list of shell variables that are currently exported (there are quite a few, so you will need to scroll to get a sense of them).</p>
<div class="cell tag_remove-input tag_output_scroll docutils container">
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">env</span></code> program, when run with no arguments, will print the environment variables that were passed to it by its parent.
So when we run it, we expect its output to be the same as what the shell <code class="docutils literal notranslate"><span class="pre">export</span></code> builtin printed.</p>
<div class="cell tag_remove-input tag_output_scroll docutils container">
</div>
<p>Let’s now use <code class="docutils literal notranslate"><span class="pre">env</span></code> and <code class="docutils literal notranslate"><span class="pre">grep</span></code> to explore how we can modify the environment variables passed to a new process.</p>
<div class="cell tag_remove-input docutils container">
</div>
<ol class="arabic simple">
<li><p>The first command line is a pipeline, <code class="docutils literal notranslate"><span class="pre">env</span> <span class="pre">|</span> <span class="pre">grep</span> <span class="pre">MYVAR</span></code>.  We see that the environment passed to <code class="docutils literal notranslate"><span class="pre">env</span></code> does not contain MYVAR.</p></li>
<li><p>The second line explicitly tells the shell to add <code class="docutils literal notranslate"><span class="pre">MYVAR=Hello</span></code> to the environment variables passed to the process created to run <code class="docutils literal notranslate"><span class="pre">env</span></code>.  The output of grep confirms this.</p></li>
<li><p>The third command confirms that second command did not add  MYVAR to the current bash processes shell variables.</p></li>
<li><p>The fourth command <code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">MYVAR=Goodbye</span></code> both sets a shell variable MYVAR and marks it as exported.</p></li>
<li><p>Confirms that MYVAR is now automatically part of the environment variables passed to new processes.</p></li>
<li><p>Confirms MYVAR is a variable in the current shell</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Notice, like the current working directory, the environment variables are copied to a new process.  As such, the parent and child have independent copies.  Changing a variable’s value in a child does not affect the parent’s copy.</p>
<p>Eg.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">X</span><span class="o">=</span>hello
$<span class="w"> </span><span class="o">(</span><span class="nb">echo</span><span class="w"> </span><span class="nv">$X</span><span class="p">;</span><span class="w"> </span><span class="nv">X</span><span class="o">=</span>goodbye<span class="p">;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$X</span><span class="o">)</span>
hello
goodbye
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$X</span>
hello
$<span class="w"> </span>
</pre></div>
</div>
<p>Notice the parenthesis runs the enclosed commands in a sub-shell. We see the value of X start in the sub-shell as the value in the parent <code class="docutils literal notranslate"><span class="pre">hello</span></code>.  This is expected given that X is an exported variable in the parent.  We see that modifying X in the child has no effect on the value of X in the parent.  This is as expected, given that the parent and child are really two independent processes with their own environment variables.</p>
</div>
</section>
<section id="open-file-descriptors">
<h3><span class="section-number">4.11.4. </span>Open File Descriptors<a class="headerlink" href="#open-file-descriptors" title="Permalink to this heading">#</a></h3>
<p>The final aspect of the command execution environment that we want to focus on is the open file descriptors.  Recall the UNIX kernel maintains a table of open file descriptors for every process.  As such, each process has its own table that gets updated as the process executes file operations such as <code class="docutils literal notranslate"><span class="pre">open</span></code> and <code class="docutils literal notranslate"><span class="pre">close</span></code> system calls. Where the first establishes a new entry in the process’s table the second clears an entry.</p>
<p>Also, remember that a process identifies an open stream as a index into its file descriptor table, with indexes 0, 1 and 2 having special meaning as standard input, standard output and standard error.</p>
<p>When the kernel launches a new process, it initializes the new process’s file descriptor table to be a copy of the parent’s.  In this way, the parent can pass along open input and output streams to its children.</p>
<p>This is why external commands, which run as child processes of a shell, by default will have their standard streams connected to the same places as the shell processes that launched them.</p>
<p>When we specify re-directions, the shell will open, close and copy file descriptors to set things up correctly for the new program to be executed. After doing this, the shell starts the child binary running.  From the new program’s perspective, it does not need to do anything to set up the standard stream connections.</p>
<div class="admonition-fork-and-exec admonition">
<p class="admonition-title">Fork and Exec</p>
<p>On UNIX, the way a new child process is created to run a different binary is actually a two step procedure. First, the parent calls <code class="docutils literal notranslate"><span class="pre">fork</span></code> to create a child process that is running a copy of the same program as the parent.  As such, the <code class="docutils literal notranslate"><span class="pre">fork</span></code> call returns twice - once in the parent and once in the child.  To distinguish the two, it returns a different value to the parent and child.  As a separate system call, a process can replace the binary that it is running with the <code class="docutils literal notranslate"><span class="pre">exec</span></code> system call.</p>
<p>To start an external command as a process,  a shell in UNIX will typically first <code class="docutils literal notranslate"><span class="pre">fork</span></code> a copy of itself. The child shell process will automatically inherit the working directory, environment variables, and open file descriptors.   The child will then use the <code class="docutils literal notranslate"><span class="pre">open</span></code>, <code class="docutils literal notranslate"><span class="pre">close</span></code>, and <code class="docutils literal notranslate"><span class="pre">dup</span></code> system calls to set up any necessary redirections.  After this, the child shell process will call <code class="docutils literal notranslate"><span class="pre">exec</span></code> to start the specified binary for the external command.  At this point, the child is no longer running the shell binary (eg. <code class="docutils literal notranslate"><span class="pre">/bin/bash</span></code>) but rather is running the specified binary of the external command (eg. <code class="docutils literal notranslate"><span class="pre">/bin/ls</span></code>)</p>
<p>The parent shell will then go on to either wait for the child to exit, or immediately proceed to the next command depending on if the command was started with the background operator.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>In a modern UNIX system, the kernel is maintaining a lot of information for every process.  The working directory, file descriptor table, and exported environment variables are the core standard ones that the shell provides to a new process it starts.
There are two additional standard ones that a UNIX kernel maintains for every process.   1) the default “file creation mode mask” and 2) the set of “ignored` signals”.  We will touch upon both of these things, along with “credentials”, in the next chapter when we delve further into processes.</p>
</div>
</section>
</section>
<section id="exercises">
<h2><span class="section-number">4.12. </span>Exercises<a class="headerlink" href="#exercises" title="Permalink to this heading">#</a></h2>
<section id="given-the-following-command-line-determine-how-it-will-be-split-into-tokens-and-which-token-is-the-command-and-which-are-the-arguments">
<h3><span class="section-number">4.12.1. </span>Given the following command line determine how it will be split into tokens and which token is the command and which are the arguments.<a class="headerlink" href="#given-the-following-command-line-determine-how-it-will-be-split-into-tokens-and-which-token-is-the-command-and-which-are-the-arguments" title="Permalink to this heading">#</a></h3>
<p>Again we use <code class="docutils literal notranslate"><span class="pre">\</span> </code>, <code class="docutils literal notranslate"><span class="pre">\t</span></code> and <code class="docutils literal notranslate"><span class="pre">\n</span></code> to indicate space, tab and newline characters respectively.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\ <span class="n">foo</span>\<span class="n">t</span>\<span class="n">t</span>\<span class="n">t</span>\<span class="n">bar</span> \<span class="n">blah</span>\ <span class="n">goo</span>\<span class="n">n</span> 
</pre></div>
</div>
<div class="cell tag_remove-input tag_hide-output docutils container">
</div>
</section>
<section id="given-the-following-command-line-determine-how-many">
<h3><span class="section-number">4.12.2. </span>Given the following command line determine how many:<a class="headerlink" href="#given-the-following-command-line-determine-how-many" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>pipelines are started,</p></li>
<li><p>jobs are started,</p></li>
<li><p>and processes are started</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sleep<span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>cat<span class="w"> </span>/etc/passwd<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>jov<span class="w"> </span><span class="p">&amp;</span><span class="w"> </span>sleep<span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span>goodbye<span class="w"> </span><span class="p">|</span><span class="w"> </span>tr<span class="w"> </span>o<span class="w"> </span>O<span class="w">  </span><span class="p">&amp;</span><span class="w"> </span>sleep<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>ps<span class="w"> </span>auxgww<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>jov<span class="w"> </span><span class="p">|</span><span class="w"> </span>wc<span class="w"> </span>-l<span class="w"> </span><span class="p">&amp;</span>
</pre></div>
</div>
<div class="cell tag_remove-input tag_hide-output docutils container">
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./unix"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="files.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">3. </span>Organizing and Managing Information as a Tree of Files and Directories</p>
      </div>
    </a>
    <a class="right-next"
       href="shelldetails.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">5. </span>The Shell - Part II: Some UNIX details</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#our-interface-to-the-kernel">4.1. Our interface to the Kernel</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#system-calls">4.1.1. System calls</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bash">4.2. Bash</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#documentation-and-manuals">4.2.1. Documentation and manuals</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#man-bash">4.2.2. man bash</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#info-bash">4.2.2.1. info bash</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bash-builtin-help">4.2.2.2. bash builtin <code class="docutils literal notranslate"><span class="pre">help</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#shell-session">4.3. Shell Session</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#terminal-windows-and-the-shell">4.3.1. Terminal Windows and the Shell</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#line-oriented-conversation">4.4. Line oriented conversation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lines">4.4.1. Lines</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-prompt">4.4.2. The Prompt</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#our-first-shell-session">4.5. Our first shell session</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#command-lines">4.6. Command lines</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#three-simple-examples">4.6.1. Three simple examples</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#command-line-processing">4.7. Command line processing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interactive-vs-non-interactive-scripts">4.7.1. Interactive vs non-interactive (scripts)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overview-the-six-steps-of-command-line-processing">4.7.2. Overview: The six steps of command line processing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-breaking-down-a-command-line-into-simple-commands-and-arguments">4.7.3. Step 1: Breaking down a “Command line” into Simple Commands and Arguments</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#command-versus-arguments">4.7.3.1. Command versus Arguments</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#comments">4.7.3.2. Comments</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-command-line-splitting-examples">4.7.3.3. Simple Command Line Splitting examples</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#quotes-and-command-line-splitting">4.7.3.4. Quotes and Command Line Splitting</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#escaping-blanks">4.7.3.4.1. Escaping blanks</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">4.7.3.5. Summary</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#command-line-history">4.7.3.6. Command line history</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-perform-expansions">4.7.4. Step 2: Perform Expansions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nine-command-line-expansions">4.7.4.1. Nine Command line Expansions</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#brace-expansion">4.7.4.1.1. Brace Expansion</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#tilde-expansion">4.7.4.1.2. Tilde Expansion</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#parameter-and-variable-expansion">4.7.4.1.3. Parameter and Variable Expansion</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#command-substitution">4.7.4.1.4. Command Substitution</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#arithmetic-expansion">4.7.4.1.5. Arithmetic Expansion</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#process-substitution">4.7.4.1.6. Process Substitution</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#word-splitting-on-expansion">4.7.4.1.7. Word Splitting on Expansion</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#filename-expansion">4.7.4.1.8. Filename Expansion</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#quote-removal">4.7.4.1.9. Quote Removal</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#quoting-and-expansions">4.7.4.2. Quoting and Expansions</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#single-quotes">4.7.4.3. Single quotes</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#double-quotes">4.7.4.4. Double quotes</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-parse-redirections">4.7.5. Step 3: Parse Redirections</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#processes">4.7.5.1. Processes</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#streams-standard-input-output-and-error">4.7.5.2. Streams: Standard Input, Output and Error</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ascii-streams">4.7.5.3. ASCII streams</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#standard-error">4.7.5.3.1. Standard Error</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#streams-and-files">4.7.5.4. Streams and Files</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#opening-streams-and-file-descriptors">4.7.5.5. Opening streams and File Descriptors</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#terminals-and-streams">4.7.5.6. Terminals and Streams</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#defaults">4.7.5.7. Defaults</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#overriding-the-defaults">4.7.5.8. Overriding the defaults</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#redirection-examples">4.7.5.9. Redirection Examples</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#standard-output-and-redirection">4.7.5.9.1. Standard output and redirection</a><ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#appending-to-a-file">4.7.5.9.1.1. Appending to a file</a></li>
</ul>
</li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#standard-input-redirection">4.7.5.9.2. Standard Input redirection</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#pipes">4.7.5.9.3. Pipes</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#standard-error-redirection">4.7.5.9.4. Standard Error redirection</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-execute-the-command">4.7.6. Step 4: Execute the command</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#builtin-vs-externals">4.7.6.1. Builtin vs Externals</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#builtins">4.7.6.1.1. Builtins</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#external-shell-commands">4.7.6.1.2. External “Shell Commands”</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#locating-external-commands">4.7.6.1.3. Locating  External commands</a><ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#commands-as-pathnames">4.7.6.1.3.1. Commands as pathnames</a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#commands-as-files-within-the-path-list">4.7.6.1.3.2. Commands as files within the PATH list</a></li>
</ul>
</li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#executing-external-commands-creating-processes">4.7.6.1.4. Executing External commands (Creating Processes)</a><ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#the-birth-of-processes">4.7.6.1.4.1. The Birth of Processes</a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#fork-exec">4.7.6.1.4.2. Fork-Exec</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-optionally-wait-for-command-to-complete">4.7.7. Step 5: Optionally wait for command to complete</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#synchronous">4.7.7.1. Synchronous</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exit-status">4.7.7.2. Exit Status</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#asynchronous-background-commands">4.7.7.3. Asynchronous (background) commands</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-6-print-prompt-if-interactive">4.7.8. Step 6: Print prompt if interactive</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#interactive-mode">4.7.8.1. Interactive Mode</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#non-interactive-mode-script-mode">4.7.8.2. Non-Interactive Mode (Script Mode)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#four-forms-of-command-lines">4.8. Four Forms of Command lines</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-commands">4.8.1. Simple Commands</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pipelines">4.8.2. Pipelines</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#a-building-block-for-composing-commands">4.8.2.1. A building block for composing commands</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#counting-wc">4.8.2.1.1. Counting (<code class="docutils literal notranslate"><span class="pre">wc</span></code>):</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#searching-grep">4.8.2.1.2. Searching  (<code class="docutils literal notranslate"><span class="pre">grep</span></code>)</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pipeline-examples">4.8.2.2. Pipeline examples</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#a-two-command-pipeline">4.8.2.2.1. A Two command pipeline</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#a-three-command-pipeline">4.8.2.2.2. A three command pipeline</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#pipelines-vs-simple-commands">4.8.2.2.3. Pipelines vs simple commands</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#list-of-commands">4.8.3. List of Commands</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sequential-list-of-commands">4.8.3.1. Sequential list of commands</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#background-asynchronous">4.8.3.2. Background / Asynchronous</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#and-list">4.8.3.3. AND list</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#or-list">4.8.3.4. OR list</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compound-commands">4.8.4. Compound Commands</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#loops">4.8.4.1. Loops</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#conditionals">4.8.4.2. Conditionals</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#groups">4.8.4.3. Groups</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#grouping">4.8.4.3.1. () grouping</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">4.8.4.3.2. {} grouping</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#user-defined-shell-functions">4.9. User defined shell Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aliases">4.10. Aliases</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#command-execution-environment">4.11. Command Execution Environment</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#process-inherited-portions">4.11.1. Process inherited Portions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#working-directory">4.11.2. Working directory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exported-shell-variables">4.11.3. Exported Shell Variables</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#open-file-descriptors">4.11.4. Open File Descriptors</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">4.12. Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#given-the-following-command-line-determine-how-it-will-be-split-into-tokens-and-which-token-is-the-command-and-which-are-the-arguments">4.12.1. Given the following command line determine how it will be split into tokens and which token is the command and which are the arguments.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#given-the-following-command-line-determine-how-many">4.12.2. Given the following command line determine how many:</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jonathan Appavoo
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2021.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>